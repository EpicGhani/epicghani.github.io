(()=>{var e,t=Object.defineProperty,i=Object.defineProperties,o=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,a=(e,i,o)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[i]=o,l=(e,t)=>{for(var i in t||={})s.call(t,i)&&a(e,i,t[i]);if(n)for(var i of n(t))r.call(t,i)&&a(e,i,t[i]);return e},h=(e,t)=>i(e,o(t)),c=(e=>"undefined"!=typeof require?require:"undefined"!=typeof Proxy?new Proxy(e,{get:(e,t)=>("undefined"!=typeof require?require:e)[t]}):e)((function(e){if("undefined"!=typeof require)return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')})),d=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},p=(e,t,i)=>(d(e,t,"read from private field"),i?i.call(e):t.get(e)),m=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},y=(e,t,i,o)=>(d(e,t,"write to private field"),o?o.call(e,i):t.set(e,i),i),f=(e,t,i)=>(d(e,t,"access private method"),i),g=(e,t,i)=>new Promise(((o,n)=>{var s=e=>{try{a(i.next(e))}catch(e){n(e)}},r=e=>{try{a(i.throw(e))}catch(e){n(e)}},a=e=>e.done?o(e.value):Promise.resolve(e.value).then(s,r);a((i=i.apply(e,t)).next())})),x=Symbol("time"),w=Symbol("roomUid"),b=Symbol("timeLeftOriginal"),v=Symbol("promiseResolve"),S=Symbol("promiseReject"),C=class{constructor(e,t,i=!1){this.rejected=!1,this.done=!1,this.settled=!1,this[w]=$e.current.uid||null,this.name=t&&t.toString(),this.isUi=i,this[x]=0,this[b]=e/1e3,this.timeLeft=this[b],this.promise=new Promise(((e,t)=>{this[v]=e,this[S]=t})),P.timers.add(this)}then(e){return this.promise.then(e)}catch(e){return this.promise.catch(e)}get time(){return this[x]}set time(e){this[x]=e}update(){!0!==this.rejected&&!0!==this.done?(this[x]+=this.isUi?Ue.timeUi:Ue.time,$e.current.uid!==this[w]&&null!==this[w]&&this.reject({info:"Room has been switched",from:"timer"}),0!==this.timeLeft&&(this.timeLeft=this[b]-this.time,this.timeLeft<=0&&this.resolve())):this.remove()}resolve(){this.settled||(this.done=!0,this.settled=!0,this[v](),this.remove())}reject(e){this.settled||(this.rejected=!0,this.settled=!0,this[S](e),this.remove())}remove(){P.timers.delete(this)}},P={timers:new Set,counter:0,add:(e,t)=>new C(e,t,!1),addUi:(e,t)=>new C(e,t,!0),updateTimers(){for(const e of this.timers)e.update()}},M=P,k=class extends PIXI.sound.filters.Filter{constructor(e,t){const{audioContext:i}=PIXI.sound.context,o=i.createPanner();o.panningModel="equalpower",o.distanceModel="inverse",o.refDistance=e,o.rolloffFactor=t;super(o),this._panner=o}reposition(e){e.kill||(this._panner.positionX.value=e.x/camera.referenceLength,this._panner.positionY.value=e.y/camera.referenceLength)}destroy(){super.destroy(),this._panner=null}},I=new Map,A=null!=(e=[])?e:[],O={};for(const e of A)O[e.name]=e;var D={},T=Object.keys(PIXI.sound.filters).filter((e=>"Filter"!==e&&"StreamFilter"!==e)),E={};for(const e of T)E[e]=PIXI.sound.filters[e];var B=(e,t)=>Math.random()*(t-e)+e,L=(e,t)=>{const i=PIXI.sound.exists(e)&&PIXI.sound.find(e);if(i)return t(i,e);if(e in D)return t(D[e],e);if(e in O){let i;for(const o of O[e].variants){const e=`pixiSound-${o.uid}`;i=t(D[e],e)}return i}throw new Error(`[sounds] Sound "${e}" was not found. Is it a typo?`)},N=(e,t)=>((e,t,i)=>{var o,n,s,r,a;const l=PIXI.sound.find(`pixiSound-${t.uid}`).play(i);return(null==(o=e.volume)?void 0:o.enabled)?l.volume=B(e.volume.min,e.volume.max)*((null==i?void 0:i.volume)||1):void 0!==(null==i?void 0:i.volume)&&(l.volume=i.volume),(null==(n=e.pitch)?void 0:n.enabled)?l.speed=B(e.pitch.min,e.pitch.max)*((null==i?void 0:i.speed)||1):void 0!==(null==i?void 0:i.speed)&&(l.speed=i.speed),(null==(s=e.distortion)?void 0:s.enabled)&&X.addDistortion(l,B(e.distortion.min,e.distortion.max)),(null==(r=e.reverb)?void 0:r.enabled)&&X.addReverb(l,B(e.reverb.secondsMin,e.reverb.secondsMax),B(e.reverb.decayMin,e.reverb.decayMax),e.reverb.reverse),(null==(a=e.eq)?void 0:a.enabled)&&X.addEqualizer(l,...e.eq.bands.map((e=>B(e.min,e.max)))),l})(e,e.variants[Math.floor(Math.random()*e.variants.length)],t),X={load(e){return g(this,null,(function*(){const t=[];return L(e,((e,i)=>{const o=PIXI.sound.play(i,{muted:!0});o instanceof Promise?(t.push(o),o.then((e=>{e.stop()}))):o.stop()})),yield Promise.all(t),e}))},play(e,t){if(e in O){const i=O[e];return N(i,t)}if(e in D)return D[e].play(t);throw new Error(`[sounds.play] Sound "${e}" was not found. Is it a typo?`)},playAt(e,t,i){const o=X.play(e,i),{panning:n}=O[e];return o instanceof Promise?o.then((e=>{X.addPannerFilter(e,t,n.refDistance,n.rolloffFactor)})):X.addPannerFilter(o,t,n.refDistance,n.rolloffFactor),o},stop(e){e?"string"==typeof e?L(e,(e=>e.stop())):e.stop():PIXI.sound.stopAll()},pause(e){e?L(e,(e=>e.pause())):PIXI.sound.pauseAll()},resume(e){e?L(e,(e=>e.resume())):PIXI.sound.resumeAll()},exists:e=>e in O||e in D,playing(e){if(!e)return PIXI.sound.isPlaying();if(e in D)return D[e].isPlaying;if(!(e in O))throw new Error(`[sounds] Sound "${e}" was not found. Is it a typo?`);for(const t of O[e].variants)if(D[`pixiSound-${t.uid}`].isPlaying)return!0;return!1},volume:(e,t)=>(void 0!==t&&("string"==typeof e?L(e,(e=>{e.volume=t})):e.volume=t),"string"==typeof e?L(e,(e=>e.volume)):e.volume),globalVolume(e){PIXI.sound.volumeAll=e},fade(e,t=0,i=1e3){const o={time:performance.now(),value:null};o.value=e?X.volume(e):PIXI.sound.context.volume;const n=s=>{const r=s-o.time,a=Math.min(r/i,1),l=o.value+(t-o.value)*a;e?X.volume(e,l):X.globalVolume(l),a<1&&requestAnimationFrame(n)};requestAnimationFrame(n)},addFilter(e,t,i){const o=t;if(o.preserved=i,!1===e)PIXI.sound.filtersAll=[...PIXI.sound.filtersAll||[],o];else if("string"==typeof e)L(e,(e=>{e.filters=[...e.filters||[],o]}));else{if(!e)throw new Error(`[sounds.addFilter] Invalid sound: ${e}`);e.filters=[...e.filters||[],o]}},addDistortion(e,t){const i=new PIXI.sound.filters.DistortionFilter(t);return X.addFilter(e,i,"DistortionFilter"),i},addEqualizer(e,t,i,o,n,s,r,a,l,h,c){const d=new PIXI.sound.filters.EqualizerFilter(t,i,o,n,s,r,a,l,h,c);return X.addFilter(e,d,"EqualizerFilter"),d},addMonoFilter(e){const t=new PIXI.sound.filters.MonoFilter;return X.addFilter(e,t,"MonoFilter"),t},addReverb(e,t,i,o){const n=new PIXI.sound.filters.ReverbFilter(t,i,o);return X.addFilter(e,n,"ReverbFilter"),n},addStereoFilter(e,t){const i=new PIXI.sound.filters.StereoFilter(t);return X.addFilter(e,i,"StereoFilter"),i},addPannerFilter(e,t,i,o){const n=new k(i,o);return X.addFilter(e,n,"PannerFilter"),I.set(t,n),e.on("end",(()=>{I.delete(t)})),n},addTelephone(e){const t=new PIXI.sound.filters.TelephoneFilter;return X.addFilter(e,t,"TelephoneFilter"),t},removeFilter(e,t){const i=t=>{"string"==typeof e?L(e,(e=>{e.filters=t})):e.filters=t};if(!e&&!t)return void(PIXI.sound.filtersAll=[]);if(e&&!t)return void i([]);let o;o=e?"string"==typeof e?L(e,(e=>e.filters)):e.filters:PIXI.sound.filtersAll,t&&!t.includes("Filter")&&(t+="Filter");const n=[...o];o.forEach(((e,i)=>{e.preserved===t&&n.splice(i,1)})),e?i(n):PIXI.sound.filtersAll=n},speed(e,t){if(t)return"string"==typeof e?L(e,(e=>{e.speed=t})):e.speed=t,t;if("string"==typeof e){if(e in O)return D[O[e].variants[0].uid].speed;if(e in D)return D[e].speed;throw new Error(`[sounds.speed] Invalid sound name: ${e}. Is it a typo?`)}return e.speed},speedAll(e){PIXI.sound.speedAll=e},toggleMuteAll:()=>PIXI.sound.toggleMuteAll(),togglePauseAll:()=>PIXI.sound.togglePauseAll()},_=X,R=document.querySelector(".ct-aLoadingScreen"),F=R.querySelector(".ct-aLoadingBar"),K=e=>("/"===(e=e.replace(/\\/g,"/"))[0]&&(e=e.slice(1)),e.split("/").filter((e=>e))),Y=e=>{if(!G.tree)throw new Error("[res] Asset tree was not exported; check your project's export settings.");let t=G.tree;for(const i of e){const o=t.find((e=>e.name===i&&"folder"===e.type));if(!o)throw new Error(`[res] Could not find folder ${i} in path ${e.join("/")}`);t=o.entries}return t},G={sounds:O,pixiSounds:D,textures:{},tree:!1,loadScript(e=Ke("url","ct.res.loadScript")){var t=document.createElement("script");t.src=e;const i=new Promise(((e,i)=>{t.onload=()=>{e()},t.onerror=()=>{i()}}));return document.getElementsByTagName("head")[0].appendChild(t),i},loadTexture(){return g(this,arguments,(function*(e=Ke("url","ct.res.loadTexture"),t=Ke("name","ct.res.loadTexture"),i={}){let o;try{o=yield PIXI.Assets.load(e)}catch(t){throw console.error(`[ct.res] Could not load image ${e}`),t}const n=[o];n.shape=o.shape=i.shape||{},o.defaultAnchor=n.defaultAnchor=new PIXI.Point(i.anchor.x||0,i.anchor.x||0);const s=Ue.getHitArea(o.shape);return s&&(o.hitArea=n.hitArea=s),G.textures[t]=n,n}))},loadAtlas(){return g(this,arguments,(function*(e=Ke("url","ct.res.loadAtlas")){const t=yield PIXI.Assets.load(e);for(const e in t.animations){const i=t.animations[e],o=t.data.animations;for(let n=0,s=o[e].length;n<s;n++){const s=o[e][n];i[n].shape=t.data.frames[s].shape}i.shape=i[0].shape||{},G.textures[e]=i;const n=Ue.getHitArea(G.textures[e].shape);if(n){G.textures[e].hitArea=n;for(const t of G.textures[e])t.hitArea=n}}return Object.keys(t.animations)}))},unloadAtlas(){return g(this,arguments,(function*(e=Ke("url","ct.res.unloadAtlas")){const{animations:t}=PIXI.Assets.get(e);if(t){for(const e of t)delete G.textures[e];yield PIXI.Assets.unload(e)}else console.log(`[ct.res] Attempt to unload an atlas that was not loaded/was unloaded already: ${e}`)}))},loadBitmapFont(){return g(this,arguments,(function*(e=Ke("url","ct.res.loadBitmapFont")){yield PIXI.Assets.load(e)}))},unloadBitmapFont(){return g(this,arguments,(function*(e=Ke("url","ct.res.unloadBitmapFont")){yield PIXI.Assets.unload(e)}))},loadSound:(e=Ke("path","ct.res.loadSound"),t=Ke("name","ct.res.loadSound"),i=!0)=>new Promise(((o,n)=>{const s=PIXI.sound.add(t,{url:e,preload:i,loaded:i?e=>{e?n(e):(G.pixiSounds[t]=s,o(t))}:void 0});i||o(t)})),loadGame(){return g(this,null,(function*(){const e=["./img/a0.{webp,png}.ae0d599989.json","./img/a1.{webp,png}.789c555d03.json","./img/a2.{webp,png}.7882704b7b.json","./img/a3.{webp,png}.92882afe96.json","./img/a4.{webp,png}.6c8cd52f16.json","./img/a5.{webp,png}.7414434f8b.json","./img/a6.{webp,png}.9f564453c0.json","./img/a7.{webp,png}.fb24022caa.json","./img/a8.{webp,png}.67cc33f6bb.json","./img/a9.{webp,png}.8e56cf8c98.json","./img/a10.{webp,png}.19e51a0ea4.json","./img/a11.{webp,png}.668e9b1dec.json","./img/a12.{webp,png}.3679bc5a9f.json"],t={},i={"Trade Gothic LT Bold_400":"qcb9tjtrQNm7H4.xml","Geist-Regular_400":"BdNGWmNGgrKJNN.xml","Ridley Grotesk Bold_400":"5n8W6R95fPfwNn.xml"},o=e.length;let n=0;const s=[];s.push(...e.map((e=>G.loadAtlas(e).then((e=>{var t;return n++,t=n/o*100,R.setAttribute("data-progress",String(t)),F.style.width=t+"%",e})))));for(const e in t)s.push(G.loadTexture(t[e].source,e,{anchor:t[e].anchor,shape:t[e].shape}));for(const e in i)s.push(G.loadBitmapFont(i[e]));for(const e of A)for(const t of e.variants)s.push(G.loadSound(t.source,`pixiSound-${t.uid}`,e.preload));yield Promise.all(s),R.classList.add("hidden")}))},getTexture:(e,t)=>{if(null===t&&(t=void 0),-1===e)return void 0!==t?PIXI.Texture.EMPTY:[PIXI.Texture.EMPTY];if(!(e in G.textures))throw new Error(`Attempt to get a non-existent texture ${e}`);const i=G.textures[e];return void 0!==t?i[t]:i},getTextureShape(e){if(-1===e)return{type:"point"};if(!(e in G.textures))throw new Error(`Attempt to get a shape of a non-existent texture ${e}`);return G.textures[e].shape},getChildren:e=>Y(K(e||"")).filter((e=>"folder"!==e.type)),getOfType:(e,t)=>Y(K(t||"")).filter((t=>t.type===e)),getAll(e){const t=Y(K(e||"")),i=[],o=e=>{for(const t of e)"folder"===t.type?o(t.entries):i.push(t)};return o(t),i},getAllOfType(e,t){const i=Y(K(t||"")),o=[],n=t=>{for(const i of t)"folder"===i.type&&n(i.entries),i.type===e&&o.push(i)};return n(i),o}};if(document.fonts)for(const e of document.fonts)e.load();var U,j,W,H,$=G,J={},z=class extends PIXI.TilingSprite{constructor(e,t=0,i=0,o={movementX:0,movementY:0,parallaxX:0,parallaxY:0,repeat:"repeat",scaleX:0,scaleY:0,shiftX:0,shiftY:0}){let{width:n,height:s}=Fe;const r=e instanceof PIXI.Texture?e:$.getTexture(e,t||0);"no-repeat"!==o.repeat&&"repeat-x"!==o.repeat||(s=r.height*(o.scaleY||1)),"no-repeat"!==o.repeat&&"repeat-y"!==o.repeat||(n=r.width*(o.scaleX||1)),super(r,n,s),this.parallaxX=1,this.parallaxY=1,this.shiftX=0,this.shiftY=0,this.movementX=0,this.movementY=0,"string"==typeof e?(J[e]||(J[e]=[]),J[e].push(this)):(J.OTHER||(J.OTHER=[]),J.OTHER.push(this)),_e.list.BACKGROUND.push(this),mt.push(this),this.on("destroyed",(()=>{_e.list.BACKGROUND.splice(_e.list.BACKGROUND.indexOf(this),1),mt.splice(mt.indexOf(this),1)})),this.zIndex=i,this.anchor.set(0,0),o&&Object.assign(this,o),this.scaleX&&(this.tileScale.x=Number(this.scaleX)),this.scaleY&&(this.tileScale.y=Number(this.scaleY)),this.reposition()}onStep(){this.shiftX+=Ue.time*this.movementX,this.shiftY+=Ue.time*this.movementY}reposition(){const e=this.isUi?{x:0,y:0,width:Fe.width,height:Fe.height}:Fe.getBoundingBox(),t=Fe.x-Fe.width/2,i=Fe.y-Fe.height/2;"repeat-x"!==this.repeat&&"no-repeat"!==this.repeat?(this.y=e.y,this.tilePosition.y=-this.y-i*(this.parallaxY-1)+this.shiftY,this.height=e.height+1):this.y=this.shiftY+e.y*(this.parallaxY-1),"repeat-y"!==this.repeat&&"no-repeat"!==this.repeat?(this.x=e.x,this.tilePosition.x=-this.x-t*(this.parallaxX-1)+this.shiftX,this.width=e.width+1):this.x=this.shiftX+e.x*(this.parallaxX-1)}onDraw(){this.reposition()}static onCreate(){}static onDestroy(){}get isUi(){return!!this.parent&&Boolean(this.parent.isUi)}},V={list:J,add(e,t=0,i=0,o){if(o||(o=$e.current),!e)throw new Error("[backgrounds] The texName argument is required.");const n=new z(e,t,i);return o instanceof We&&o.backgrounds.push(n),o.addChild(n),n}},q=class extends PIXI.Sprite{},Q=class extends PIXI.Container{},Z=class extends PIXI.Container{constructor(e){if(super(),this.pixiTiles=[],e){this.zIndex=e.depth,this.tiles=e.tiles.map((e=>l({},e))),e.extends&&Object.assign(this,e.extends);for(let t=0,i=e.tiles.length;t<i;t++){const i=e.tiles[t],o=$.getTexture(i.texture),n=new q(o[i.frame]);n.anchor.x=o[0].defaultAnchor.x,n.anchor.y=o[0].defaultAnchor.y,n.shape=o.shape,n.scale.set(i.scale.x,i.scale.y),n.rotation=i.rotation,n.alpha=i.opacity,n.tint=i.tint,n.x=i.x,n.y=i.y,this.addChild(n),this.pixiTiles.push(n),this.tiles[t].sprite=n}e.cache&&this.cache()}else this.tiles=[];_e.list.TILEMAP.push(this),this.on("destroyed",(()=>{_e.list.TILEMAP.splice(_e.list.TILEMAP.indexOf(this),1)}))}addTile(e,t,i,o=0){if(this.cached)throw new Error("[ct.tiles] Adding tiles to cached tilemaps is forbidden. Create a new tilemap, or add tiles before caching the tilemap.");const n=$.getTexture(e,o),s=new q(n);return s.x=t,s.y=i,s.shape=n.shape,this.tiles.push({texture:e,frame:o,x:t,y:i,width:s.width,height:s.height,sprite:s,opacity:1,rotation:1,scale:{x:1,y:1},tint:16777215}),this.addChild(s),this.pixiTiles.push(s),s}cache(e=1024){if(this.cached)throw new Error("[ct.tiles] Attempt to cache an already cached tilemap.");const t=this.getLocalBounds(),i=Math.ceil(t.width/e),o=Math.ceil(t.height/e);this.cells=[];for(let e=0;e<o;e++)for(let e=0;e<i;e++){const e=new Q;this.cells.push(e)}for(let o=0,n=this.tiles.length;o<n;o++){const[o]=this.children,n=Math.floor((o.x-t.x)/e),s=Math.floor((o.y-t.y)/e);this.cells[s*i+n].addChild(o)}this.removeChildren();for(let e=0,t=this.cells.length;e<t;e++)0!==this.cells[e].children.length?(this.addChild(this.cells[e]),ut.pixelart&&(this.cells[e].cacheAsBitmapResolution=1),this.cells[e].cacheAsBitmap=!0):(this.cells.splice(e,1),e--,t--);this.cached=!0}cacheDiamond(e=1024){if(this.cached)throw new Error("[ct.tiles] Attempt to cache an already cached tilemap.");this.cells=[],this.diamondCellMap={};for(let t=0,i=this.tiles.length;t<i;t++){const[t]=this.children,{x:i,y:o}=Ue.rotate(t.x,2*t.y,-45),n=Math.floor(i/e),s=Math.floor(o/e),r=`${n}:${s}`;if(!(r in this.diamondCellMap)){const e=new Q;e.chunkX=n,e.chunkY=s,this.diamondCellMap[r]=e,this.cells.push(e)}this.diamondCellMap[r].addChild(t)}this.removeChildren(),this.cells.sort(((e,t)=>{const i=Math.max(e.chunkY,e.chunkX),o=Math.max(t.chunkY,t.chunkX);return i===o?t.chunkX-e.chunkX:i-o}));for(let e=0,t=this.cells.length;e<t;e++)this.addChild(this.cells[e]),this.cells[e].cacheAsBitmap=!0;this.cached=!0}},ee={create(e=0){const t=new Z;return t.zIndex=e,$e.current.addChild(t),t},addTile:(e,t,i,o,n=0)=>e.addTile(t,i,o,n),cache(e,t){e.cache(t)},cacheDiamond(e,t){e.cacheDiamond(t)}},te={templates:{},rooms:{},add(e,t){if(e.behaviors.includes(t))throw new Error(`[behaviors.add] Behavior ${t} already exists on ${e instanceof We?e.name:e.template}`);const i=e instanceof We?"rooms":"templates";if("static"===te[i][t])throw new Error(`[behaviors.add] Behavior ${t} cannot be added to ${e instanceof We?e.name:e.template} because this behavior cannot be added dynamically.`);if(!te[i][t])throw new Error(`[behaviors.add] Behavior ${t} does not exist or cannot be applied to ${i}.`);e.behaviors.push(t)},remove(e,t){if(!e.behaviors.includes(t))throw new Error(`[behaviors.remove] Behavior ${t} already exists on ${e instanceof We?e.name:e.template}`);const i=e instanceof We?"rooms":"templates";if("static"===te[i][t])throw new Error(`[behaviors.remove] Behavior ${t} cannot be removed from ${e instanceof We?e.name:e.template} because this behavior cannot be removed dynamically.`);if(!te[i][t])throw new Error(`[behaviors.remove] Behavior ${t} does not exist or cannot be applied to ${i}.`);e.behaviors.splice(e.behaviors.indexOf(t),1)},has:(e,t)=>e.behaviors.includes(t)},ie=(e,t,i)=>{var o;for(const n of e.behaviors){const s=te[t][n];"static"!==s&&s&&(null==(o=s[i])||o.apply(e))}},oe=te,ne={types:{},new:(e,t)=>(ne.types[e]=t,t),get:(e,t)=>!0===t?Object.assign({},ne.types[e]):t?Object.assign(Object.assign({},ne.types[e]),t):ne.types[e]},se=ne,re=class extends PIXI.Container{constructor(e,t){var i,o,n,s,r,a,l,h;if("Button"!==(null==e?void 0:e.baseClass))throw new Error("Don't call PixiButton class directly! Use templates.copy to create an instance instead.");super(),m(this,U,void 0),this.normalTexture=$.getTexture(e.texture,0),this.hoverTexture=e.hoverTexture?$.getTexture(e.hoverTexture,0):this.normalTexture,this.pressedTexture=e.pressedTexture?$.getTexture(e.pressedTexture,0):this.normalTexture,this.disabledTexture=e.disabledTexture?$.getTexture(e.disabledTexture,0):this.normalTexture,this.panel=new PIXI.NineSlicePlane(this.normalTexture,null!=(o=null==(i=e.nineSliceSettings)?void 0:i.left)?o:16,null!=(s=null==(n=e.nineSliceSettings)?void 0:n.top)?s:16,null!=(a=null==(r=e.nineSliceSettings)?void 0:r.right)?a:16,null!=(h=null==(l=e.nineSliceSettings)?void 0:l.bottom)?h:16);const c=-1===e.textStyle?PIXI.TextStyle.defaultStyle:se.get(e.textStyle,!0);t.customSize&&(c.fontSize=Number(t.customSize)),this.textLabel=new PIXI.Text(t.customText||e.defaultText||"",c),this.textLabel.anchor.set(.5),this.addChild(this.panel,this.textLabel),this.eventMode="dynamic",this.cursor="pointer",this.on("pointerenter",this.hover),this.on("pointerentercapture",this.hover),this.on("pointerleave",this.blur),this.on("pointerleavecapture",this.blur),this.on("pointerdown",this.press),this.on("pointerdowncapture",this.press),this.on("pointerup",this.hover),this.on("pointerupcapture",this.hover),this.on("pointerupoutside",this.blur),this.on("pointerupoutsidecapture",this.blur),this.updateNineSliceShape=e.nineSliceSettings.autoUpdate;let d=this.panel.width,p=this.panel.height;"scaleX"in t&&(d*=t.scaleX),"scaleY"in t&&(p*=t.scaleY),this.resize(d,p),Ue.reshapeNinePatch(this)}get disabled(){return p(this,U)}set disabled(e){y(this,U,e),e?(this.panel.texture=this.disabledTexture,this.eventMode="none"):(this.panel.texture=this.normalTexture,this.eventMode="dynamic")}get text(){return this.textLabel.text}set text(e){this.textLabel.text=e}get tint(){return this.panel.tint}set tint(e){this.panel.tint=e}unsize(){const{x:e,y:t}=this.scale;this.panel.scale.x*=e,this.panel.scale.y*=t,this.scale.set(1),this.textLabel.x=this.panel.width/2,this.textLabel.y=this.panel.height/2}resize(e,t){this.panel.width=e,this.panel.height=t,this.textLabel.x=e/2,this.textLabel.y=t/2}hover(){this.disabled||(this.panel.texture=this.hoverTexture)}blur(){this.disabled||(this.panel.texture=this.normalTexture)}press(){this.disabled||(this.panel.texture=this.pressedTexture)}};U=new WeakMap;var ae,le,he=class extends PIXI.TilingSprite{constructor(e,t){var i,o;if("SpritedCounter"!==e.baseClass)throw new Error("Don't call PixiScrollingTexture class directly! Use templates.copy to create an instance instead.");const n=$.getTexture(e.texture,0);super(n,n.width,n.height),m(this,j,void 0),m(this,W,void 0),m(this,H,void 0),y(this,W,this.width),y(this,H,this.height),this.anchor.set(0),"scaleX"in t&&(this.scale.x=null!=(i=t.scaleX)?i:1),"scaleY"in t&&(this.scale.y=null!=(o=t.scaleY)?o:1),this.count=e.spriteCount}get count(){return p(this,j)}set count(e){y(this,j,e),this.width=p(this,j)*p(this,W)*this.scale.x,this.height=p(this,H)*this.scale.y,this.tileScale.set(this.scale.x,this.scale.y),this.shape={type:"rect",left:0,top:0,right:p(this,W)*p(this,j),bottom:p(this,H)}}};j=new WeakMap,W=new WeakMap,H=new WeakMap;var ce=class extends PIXI.TilingSprite{constructor(e,t){var i,o;if("RepeatingTexture"!==e.baseClass)throw new Error("Don't call PixiScrollingTexture class directly! Use templates.copy to create an instance instead.");const n=$.getTexture(e.texture,0);super(n,n.width,n.height),m(this,ae,void 0),m(this,le,void 0),y(this,ae,this.width),y(this,le,this.height),this.anchor.set(0),this.scrollSpeedX=e.scrollX,this.scrollSpeedY=e.scrollY,"scaleX"in t&&(this.width=p(this,ae)*(null!=(i=t.scaleX)?i:1)),"scaleY"in t&&(this.height=p(this,le)*(null!=(o=t.scaleY)?o:1)),this.on("added",(()=>{$e.current.tickerSet.add(this)})),this.on("removed",(()=>{$e.current.tickerSet.delete(this)})),this.shape={type:"rect",left:0,top:0,right:this.width,bottom:this.height}}tick(){this.isUi?(this.tilePosition.x+=this.scrollSpeedX*Ue.timeUi,this.tilePosition.y+=this.scrollSpeedY*Ue.timeUi):(this.tilePosition.x+=this.scrollSpeedX*Ue.time,this.tilePosition.y+=this.scrollSpeedY*Ue.time)}};ae=new WeakMap,le=new WeakMap;var de,pe,ue,me,ye,fe,ge,xe,we,be,ve=document.createElement("style");document.head.appendChild(ve);var Se=class extends PIXI.Container{constructor(e,t){var i,o,n,s,r,a,l,h,c,d;if("TextBox"!==(null==e?void 0:e.baseClass))throw new Error("Don't call PixiTextBox class directly! Use templates.copy to create an instance instead.");super(),m(this,me),m(this,de,void 0),m(this,pe,void 0),m(this,ue,void 0),m(this,fe,void 0),this.onchange=()=>{},this.oninput=()=>{},m(this,ge,(e=>{e.target!==this&&this.blur()})),m(this,xe,(e=>{"Enter"===e.key&&p(this,pe)&&(f(this,me,ye).call(this,!1),e.preventDefault())})),m(this,we,(()=>{var e,t,i,o,n,s,r;const{isUi:a}=this.getRoom(),l=this.x,h=this.y,c=this.x+this.width,d=this.y+this.height,u=a?Ue.uiToCssScalar:Ue.gameToCssScalar,m=a?Ue.uiToCssCoord:Ue.gameToCssCoord,y=m(l,h),f=m(c,d),g=this.textLabel.style;if(Object.assign(p(this,fe).style,{fontSize:u(parseFloat(g.fontSize))+"px",left:y.x+"px",top:y.y+"px",width:f.x-y.x+"px",height:f.y-y.y+"px",lineHeight:f.y-y.y+"px",color:Array.isArray(g.fill)?g.fill[0]:g.fill}),g.strokeThickness?(p(this,fe).style.textStroke=`${u(g.strokeThickness/2)}px ${g.stroke}`,p(this,fe).style.webkitTextStroke=p(this,fe).style.textStroke):p(this,fe).style.textStroke=p(this,fe).style.webkitTextStroke="unset",g.dropShadow){const n=Ue.radToDeg(null!=(e=g.dropShadowAngle)?e:0);let s=Ue.ldx(null!=(t=g.dropShadowDistance)?t:0,n),r=Ue.ldy(null!=(i=g.dropShadowDistance)?i:0,n);s=u(s),r=u(r);const a=`${s}px ${r}px ${u(null!=(o=g.dropShadowBlur)?o:0)}px ${g.dropShadowColor}`;p(this,fe).style.textShadow=`${a}, ${a}`}p(this,fe).style.fontStyle=null!=(n=g.fontStyle)?n:"unset",p(this,fe).style.fontFamily=null!=(s=g.fontFamily)?s:"unset",p(this,fe).style.fontWeight=null!=(r=g.fontWeight)?r:"400",this.selectionColor?ve.innerHTML=`\n                ::selection {\n                    background: ${this.selectionColor};\n                }\n            `:ve.innerHTML=""})),m(this,be,void 0),this.normalTexture=$.getTexture(e.texture,0),this.hoverTexture=e.hoverTexture?$.getTexture(e.hoverTexture,0):this.normalTexture,this.pressedTexture=e.pressedTexture?$.getTexture(e.pressedTexture,0):this.normalTexture,this.disabledTexture=e.disabledTexture?$.getTexture(e.disabledTexture,0):this.normalTexture,this.panel=new PIXI.NineSlicePlane(this.normalTexture,null!=(o=null==(i=e.nineSliceSettings)?void 0:i.left)?o:16,null!=(s=null==(n=e.nineSliceSettings)?void 0:n.top)?s:16,null!=(a=null==(r=e.nineSliceSettings)?void 0:r.right)?a:16,null!=(h=null==(l=e.nineSliceSettings)?void 0:l.bottom)?h:16),this.maxLength=null!=(c=e.maxTextLength)?c:0,this.fieldType=null!=(d=e.fieldType)?d:"text";const u=-1===e.textStyle?PIXI.TextStyle.defaultStyle:se.get(e.textStyle,!0);t.customSize&&(u.fontSize=Number(t.customSize));let g=t.customText||e.defaultText||"";y(this,be,g),"password"===this.fieldType&&(g="•".repeat(g.length)),this.textLabel=new PIXI.Text(g,u),this.textLabel.anchor.set(.5),this.addChild(this.panel,this.textLabel),e.selectionColor&&(this.selectionColor=e.selectionColor),this.eventMode="dynamic",this.cursor="pointer",this.on("pointerenter",this.hover),this.on("pointerentercapture",this.hover),this.on("pointerleave",this.unhover),this.on("pointerleavecapture",this.unhover),this.on("pointerdown",this.press),this.on("pointerdowncapture",this.press),this.on("pointerup",this.hover),this.on("pointerupcapture",this.hover),this.on("pointerupoutside",this.unhover),this.on("pointerupoutsidecapture",this.unhover),this.updateNineSliceShape=e.nineSliceSettings.autoUpdate;let x=this.panel.width,w=this.panel.height;"scaleX"in t&&(x*=t.scaleX),"scaleY"in t&&(w*=t.scaleY),this.resize(x,w),Ue.reshapeNinePatch(this),y(this,de,!1),y(this,pe,!1),y(this,fe,document.createElement("input")),p(this,fe).type="text",p(this,fe).className="aCtJsTextboxInput",p(this,fe).addEventListener("click",(e=>{e.stopPropagation()})),p(this,fe).addEventListener("pointerup",(e=>{e.stopPropagation()})),p(this,fe).addEventListener("input",(()=>{this.oninput(p(this,fe).value)})),this.on("pointerup",(()=>{f(this,me,ye).call(this,!0)}))}get disabled(){return p(this,de)}set disabled(e){y(this,de,e),e?(this.panel.texture=this.disabledTexture,this.eventMode="none"):(this.panel.texture=this.normalTexture,this.eventMode="auto")}get isFocused(){return p(this,pe)}blur(){f(this,me,ye).call(this,!1)}focus(){f(this,me,ye).call(this,!0)}get text(){return p(this,be)}set text(e){y(this,be,e),"password"===this.fieldType?this.textLabel.text="•".repeat(e.length):this.textLabel.text=e}unsize(){const{x:e,y:t}=this.scale;this.panel.scale.x*=e,this.panel.scale.y*=t,this.scale.set(1),this.textLabel.x=this.panel.width/2,this.textLabel.y=this.panel.height/2}resize(e,t){this.panel.width=e,this.panel.height=t,this.textLabel.x=e/2,this.textLabel.y=t/2}hover(){this.disabled||(this.panel.texture=this.hoverTexture)}unhover(){this.disabled||(this.panel.texture=this.normalTexture)}press(){this.disabled||(this.panel.texture=this.pressedTexture)}};de=new WeakMap,pe=new WeakMap,ue=new WeakMap,me=new WeakSet,ye=function(e){var t,i;if(e!==p(this,pe))if(y(this,pe,e),e){if(p(this,de))return void y(this,pe,!1);Te(this),this.panel.texture=null!=(i=null!=(t=this.pressedTexture)?t:this.hoverTexture)?i:this.normalTexture,p(this,we).call(this),this.maxLength>0?p(this,fe).maxLength=this.maxLength:delete p(this,fe).maxLength,p(this,fe).type=this.fieldType,p(this,fe).value=this.text,document.body.appendChild(p(this,fe)),p(this,fe).focus(),this.textLabel.alpha=0;try{y(this,ue,ut.preventDefault),ut.preventDefault=!1}catch(e){}document.addEventListener("keydown",p(this,xe)),window.addEventListener("resize",p(this,we)),lt.stage.off("pointerup",p(this,ge))}else{this.panel.texture=this.normalTexture,this.text=p(this,fe).value,document.body.removeChild(p(this,fe)),this.textLabel.alpha=1;try{ut.preventDefault=p(this,ue)}catch(e){}this.onchange(this.text),document.removeEventListener("keydown",p(this,xe)),window.removeEventListener("resize",p(this,we)),lt.stage.on("pointerup",p(this,ge))}},fe=new WeakMap,ge=new WeakMap,xe=new WeakMap,we=new WeakMap,be=new WeakMap;var Ce,Pe,Me,ke=class extends PIXI.NineSlicePlane{constructor(e,t){var i,o,n,s,r,a,l,h;if("NineSlicePlane"!==(null==e?void 0:e.baseClass))throw new Error("Don't call PixiPanel class directly! Use templates.copy to create an instance instead.");super($.getTexture(e.texture,0),null!=(o=null==(i=e.nineSliceSettings)?void 0:i.left)?o:16,null!=(s=null==(n=e.nineSliceSettings)?void 0:n.top)?s:16,null!=(a=null==(r=e.nineSliceSettings)?void 0:r.right)?a:16,null!=(h=null==(l=e.nineSliceSettings)?void 0:l.bottom)?h:16),this.baseClass="NineSlicePlane",this.updateNineSliceShape=e.nineSliceSettings.autoUpdate;const c=this.width,d=this.height;"scaleX"in t&&(this.width=c*t.scaleX),"scaleY"in t&&(this.height=d*t.scaleY),Ue.reshapeNinePatch(this),this.blendMode=e.blendMode||PIXI.BLEND_MODES.NORMAL}},Ie=class extends PIXI.Text{constructor(e,t){var i,o,n,s;if("Text"!==(null==e?void 0:e.baseClass))throw new Error("Don't call PixiPanel class directly! Use templates.copy to create an instance instead.");let r;if(r=e.textStyle&&-1!==e.textStyle?se.get(e.textStyle,!0):{},t.customWordWrap&&(r.wordWrap=!0,r.wordWrapWidth=Number(t.customWordWrap)),t.customSize&&(r.fontSize=Number(t.customSize)),super(t.customText||e.defaultText||"",r),t.customAnchor){const e=t.customAnchor;this.anchor.set(null!=(i=null==e?void 0:e.x)?i:0,null!=(o=null==e?void 0:e.y)?o:0)}return this.shape=Ue.getRectShape(this),this.scale.set(null!=(n=t.scaleX)?n:1,null!=(s=t.scaleY)?s:1),this}},Ae=class extends PIXI.Container{constructor(){return super(),this.shape={type:"point"},this}},Oe={AnimatedSprite:class extends PIXI.AnimatedSprite{constructor(e,t){var i,o,n,s,r,a;if("AnimatedSprite"!==(null==e?void 0:e.baseClass))throw new Error("Don't call PixiButton class directly! Use templates.copy to create an instance instead.");const l=$.getTexture(e.texture);return super(l),this.anchor.x=null!=(o=null!=(i=e.anchorX)?i:l[0].defaultAnchor.x)?o:0,this.anchor.y=null!=(s=null!=(n=e.anchorY)?n:l[0].defaultAnchor.y)?s:0,this.scale.set(null!=(r=t.scaleX)?r:1,null!=(a=t.scaleY)?a:1),this.blendMode=e.blendMode||PIXI.BLEND_MODES.NORMAL,this.loop=e.loopAnimation,this.animationSpeed=e.animationFPS/60,e.playAnimationOnStart&&this.play(),this}},Button:re,Container:Ae,NineSlicePlane:ke,RepeatingTexture:ce,SpritedCounter:he,Text:Ie,TextBox:Se},De=0,Te=e=>{Ce&&Ce!==e&&Ce.blur(),Ce=e},Ee={set tex(e){if(this._tex!==e){var{playing:t}=this;this.textures=$.getTexture(e),[this.texture]=this.textures,this._tex=e,this.shape=$.getTextureShape(e),this.hitArea=this.textures.hitArea,this.anchor&&(this.anchor.x=this.textures[0].defaultAnchor.x,this.anchor.y=this.textures[0].defaultAnchor.y,t&&this.play()),"_bottomHeight"in this&&Ue.reshapeNinePatch(this)}},get tex(){return this._tex},get speed(){return Math.hypot(this.hspeed,this.vspeed)},set speed(e){if(0===e)return this._zeroDirection=this.direction,void(this.hspeed=this.vspeed=0);if(0===this.speed){const t=this._zeroDirection;return this._hspeed=e*Math.cos(t*Math.PI/180),void(this._vspeed=e*Math.sin(t*Math.PI/180))}var t=e/this.speed;this.hspeed*=t,this.vspeed*=t},get hspeed(){return this._hspeed},set hspeed(e){0===this.vspeed&&0===e&&(this._zeroDirection=this.direction),this._hspeed=e},get vspeed(){return this._vspeed},set vspeed(e){0===this.hspeed&&0===e&&(this._zeroDirection=this.direction),this._vspeed=e},get direction(){return 0===this.speed?this._zeroDirection:(180*Math.atan2(this.vspeed,this.hspeed)/Math.PI+360)%360},set direction(e){if(this._zeroDirection=e,this.speed>0){var{speed:t}=this;this.hspeed=t*Math.cos(e*Math.PI/180),this.vspeed=t*Math.sin(e*Math.PI/180)}},move(){this.gravity&&(this.hspeed+=this.gravity*Ue.time*Math.cos(this.gravityDir*Math.PI/180),this.vspeed+=this.gravity*Ue.time*Math.sin(this.gravityDir*Math.PI/180)),this.x+=this.hspeed*Ue.time,this.y+=this.vspeed*Ue.time},addSpeed(e,t){this.hspeed+=e*Math.cos(t*Math.PI/180),this.vspeed+=e*Math.sin(t*Math.PI/180)},getRoom(){let{parent:e}=this;for(;!(e instanceof We);)({parent:e}=e);return e},onBeforeCreateModifier(){this.matterEnable&&matter.onCreate(this)}},Be=function(e,t,i,o,n){o=o||$e.current,this[at]=!0,i?(this.baseClass=i.baseClass,this.parent=o,"AnimatedSprite"!==i.baseClass&&"NineSlicePlane"!==i.baseClass||(this._tex=i.texture),this.behaviors=[...i.behaviors],!1===i.visible&&(this.visible=!1)):this.behaviors=[];const s=this.scale;return Object.defineProperty(this,"scale",{get:()=>s,set:e=>{this.scale.x=this.scale.y=Number(e)}}),this[at]=!0,this.xprev=this.xstart=this.x=e,this.yprev=this.ystart=this.y=t,this._hspeed=0,this._vspeed=0,this._zeroDirection=0,this.gravity=0,this.gravityDir=90,this.zIndex=0,this.timer1=this.timer2=this.timer3=this.timer4=this.timer5=this.timer6=0,this.uid=++De,i?(Object.assign(this,{template:i.name,zIndex:i.depth,onStep:i.onStep,onDraw:i.onDraw,onBeforeCreateModifier:Ee.onBeforeCreateModifier,onCreate:i.onCreate,onDestroy:i.onDestroy}),this.zIndex=i.depth,Object.assign(this,i.extends),n&&Object.assign(this,n),"texture"in i&&!this.shape&&(this.shape=$.getTextureShape(i.texture||-1),"string"==typeof i.texture&&(this.hitArea=$.getTexture(i.texture).hitArea)),Xe.list[i.name]?Xe.list[i.name].push(this):Xe.list[i.name]=[this],this.onBeforeCreateModifier.apply(this),Xe.templates[i.name].onCreate.apply(this),Ne.apply(this)):n&&(Object.assign(this,n),this.onBeforeCreateModifier.apply(this),Ne.apply(this)),this.shape||(this.shape=$.getTextureShape(-1)),this.behaviors.length&&ie(this,"templates","thisOnCreate"),this},Le=(e,t,i,o,n)=>{if(!(e in Xe.templates))throw new Error(`[ct.templates] An attempt to create a copy of a non-existent template \`${e}\` detected. A typo?`);const s=Xe.templates[e];if(!(s.baseClass in Oe))throw new Error(`[internal -> makeCopy] Unknown base class \`${s.baseClass}\` for template \`${e}\`.`);const r=new Oe[s.baseClass](s,n);return((e,t,i,o,n,s)=>{const r=Ee,a=Object.getOwnPropertyNames(r);for(const t in a)"constructor"!==a[t]&&Object.defineProperty(e,a[t],Object.getOwnPropertyDescriptor(r,a[t]));Be.apply(e,[t,i,o,n,s])})(r,t,i,s,o,n),r},Ne=function(){this.$chashes=yt.getHashes(this);for(const e of this.$chashes)e in yt.grid?yt.grid[e].push(this):yt.grid[e]=[this]},Xe={CopyProto:Ee,Background:z,Tilemap:Z,list:{BACKGROUND:[],TILEMAP:[]},templates:{},copyIntoRoom(e,t=0,i=0,o,n={}){if(!(o&&o instanceof We))throw new Error(`Attempt to spawn a copy of template ${e} inside an invalid room. Room's value provided: ${o}`);const s=Le(e,t,i,o,n);return o.addChild(s),mt.push(s),s},copy:(e,t=0,i=0,o={})=>Xe.copyIntoRoom(e,t,i,$e.current,o),each(e){for(const t of mt)t instanceof Be&&e.apply(t,this)},withCopy(e,t){t.apply(e,this)},withTemplate(e,t){for(const i of Xe.list[e])t.apply(i,this)},exists(e){if(!(e in Xe.templates))throw new Error(`[ct.templates] templates.exists: There is no such template ${e}.`);return Xe.list[e].length>0},isCopy:e=>e&&e[at],valid:e=>"object"==typeof e&&(at in e?!e.kill:e instanceof PIXI.DisplayObject&&Boolean(e.position)),beforeStep(){},afterStep(){this.behaviors.length&&ie(this,"templates","thisOnStep")},beforeDraw(){!1},afterDraw(){if(this.behaviors.length&&ie(this,"templates","thisOnDraw"),"Button"!==this.baseClass||1===this.scale.x&&1===this.scale.y||this.unsize(),this.updateNineSliceShape&&(this.prevWidth===this.width&&this.prevHeight===this.height||(this.prevWidth=this.width,this.prevHeight=this.height,Ue.reshapeNinePatch(this))),this.transform&&this.transform._localID!==this.transform._currentLocalID||this.x!==this.xprev||this.y!==this.yprev){delete this._shape;const e=this.$chashes||[];this.$chashes=yt.getHashes(this);for(const t of e)-1===this.$chashes.indexOf(t)&&yt.grid[t].splice(yt.grid[t].indexOf(this),1);for(const t of this.$chashes)-1===e.indexOf(t)&&(t in yt.grid?yt.grid[t].push(this):yt.grid[t]=[this])}this.matterEnable&&(this.rotation=this.matterBody.angle,this.x=this.matterBody.position.x,this.y=this.matterBody.position.y,this.hspeed=this.matterBody.velocity.x,this.vspeed=this.matterBody.velocity.y)},onDestroy(){if(this.$chashes)for(const e of this.$chashes)yt.grid[e].splice(yt.grid[e].indexOf(this),1);this.matterEnable&&Matter.World.remove(rooms.current.matterWorld,this.matterBody),this.behaviors.length&&ie(this,"templates","thisOnDestroy")}},_e=Xe,Re=class extends PIXI.DisplayObject{constructor(e,t,i,o){super(),m(this,Pe,void 0),m(this,Me,void 0),this.sortDirty=!1,this.reset(e,t,i,o),this.getBounds=this.getBoundingBox}reset(e,t,i,o){this.followX=this.followY=!0,this.follow=void 0,this.targetX=this.x=e,this.targetY=this.y=t,this.z=500,y(this,Pe,i||1920),y(this,Me,o||1080),this.referenceLength=Math.max(p(this,Pe),p(this,Me))/2,this.shiftX=this.shiftY=this.interpolatedShiftX=this.interpolatedShiftY=0,this.borderX=this.borderY=null,this.minX=this.maxX=this.minY=this.maxY=void 0,this.drift=0,this.shake=0,this.shakeDecay=5,this.shakeX=this.shakeY=1,this.shakeFrequency=50,this.shakePhase=this.shakePhaseX=this.shakePhaseY=0,this.shakeMax=10}get width(){return p(this,Pe)}set width(e){y(this,Pe,e)}get height(){return p(this,Me)}set height(e){y(this,Me,e)}get scale(){return this.transform.scale}set scale(e){"number"==typeof e?this.transform.scale.x=this.transform.scale.y=e:this.transform.scale.copyFrom(e)}render(){}removeChild(){}calculateBounds(){}moveTo(e,t){this.targetX=e,this.targetY=t}teleportTo(e,t){this.targetX=this.x=e,this.targetY=this.y=t,this.shakePhase=this.shakePhaseX=this.shakePhaseY=0,this.interpolatedShiftX=this.shiftX,this.interpolatedShiftY=this.shiftY}update(e){!function(e,t){e.shake-=t*e.shakeDecay,e.shake=Math.max(0,e.shake),e.shakeMax&&(e.shake=Math.min(e.shake,e.shakeMax));const i=t*e.shakeFrequency;e.shakePhase+=i,e.shakePhaseX+=i*(1+.25*Math.sin(.1489*e.shakePhase)),e.shakePhaseY+=i*(1+.25*Math.sin(.1734*e.shakePhase))}(this,e),this.follow&&at in this.follow&&this.follow.kill&&(this.follow=!1),!this.follow&&$e.current.follow&&([this.follow]=_e.list[$e.current.follow]),this.follow&&"x"in this.follow&&"y"in this.follow&&function(e){const t=null===e.borderX?e.width/2:Math.min(e.borderX,e.width/2),i=null===e.borderY?e.height/2:Math.min(e.borderY,e.height/2),o=e.uiToGameCoord(t,i),n=e.uiToGameCoord(e.width-t,e.height-i);e.follow&&(e.followX&&(e.follow.x<o.x-e.interpolatedShiftX?e.targetX=e.follow.x-t+e.width/2:e.follow.x>n.x-e.interpolatedShiftX&&(e.targetX=e.follow.x+t-e.width/2)),e.followY&&(e.follow.y<o.y-e.interpolatedShiftY?e.targetY=e.follow.y-i+e.height/2:e.follow.y>n.y-e.interpolatedShiftY&&(e.targetY=e.follow.y+i-e.height/2)))}(this);const t=this.drift?Math.min(1,(1-this.drift)*e*60):1;this.x=this.targetX*t+this.x*(1-t),this.y=this.targetY*t+this.y*(1-t),this.interpolatedShiftX=this.shiftX*t+this.interpolatedShiftX*(1-t),this.interpolatedShiftY=this.shiftY*t+this.interpolatedShiftY*(1-t),function(e){if(void 0!==e.minX){const t=e.minX+e.width*e.scale.x*.5;e.x=Math.max(t,e.x),e.targetX=Math.max(t,e.targetX)}if(void 0!==e.maxX){const t=e.maxX-e.width*e.scale.x*.5;e.x=Math.min(t,e.x),e.targetX=Math.min(t,e.targetX)}if(void 0!==e.minY){const t=e.minY+e.height*e.scale.y*.5;e.y=Math.max(t,e.y),e.targetY=Math.max(t,e.targetY)}if(void 0!==e.maxY){const t=e.maxY-e.height*e.scale.y*.5;e.y=Math.min(t,e.y),e.targetY=Math.min(t,e.targetY)}}(this),this.x=this.x||0,this.y=this.y||0;const{listener:i}=PIXI.sound.context.audioContext;"positionX"in i?(i.positionX.value=this.x/this.referenceLength,i.positionY.value=this.y/this.referenceLength,i.positionZ.value=this.scale.x):i.setPosition(this.x/this.referenceLength,this.y/this.referenceLength,this.scale.x),I.forEach(((e,t)=>e.reposition(t)))}get computedX(){const e=(Math.sin(this.shakePhaseX)+.25*Math.sin(3.1846*this.shakePhaseX))/1.25;return this.x+e*this.shake*Math.max(this.width,this.height)/100*this.shakeX+this.interpolatedShiftX}get computedY(){const e=(Math.sin(this.shakePhaseY)+.25*Math.sin(2.8948*this.shakePhaseY))/1.25;return this.y+e*this.shake*Math.max(this.width,this.height)/100*this.shakeY+this.interpolatedShiftY}get left(){return this.computedX-this.width/2*this.scale.x}get top(){return this.computedY-this.height/2*this.scale.y}get right(){return this.computedX+this.width/2*this.scale.x}get bottom(){return this.computedY+this.height/2*this.scale.y}uiToGameCoord(e,t){const i=(e-this.width/2)*this.scale.x,o=(t-this.height/2)*this.scale.y,n=Ue.rotate(i,o,this.angle);return new PIXI.Point(n.x+this.computedX,n.y+this.computedY)}gameToUiCoord(e,t){const i=e-this.computedX,o=t-this.computedY,n=Ue.rotate(i,o,-this.angle);return new PIXI.Point(n.x/this.scale.x+this.width/2,n.y/this.scale.y+this.height/2)}getTopLeftCorner(){return this.uiToGameCoord(0,0)}getTopRightCorner(){return this.uiToGameCoord(this.width,0)}getBottomLeftCorner(){return this.uiToGameCoord(0,this.height)}getBottomRightCorner(){return this.uiToGameCoord(this.width,this.height)}getBoundingBox(){const e=new PIXI.Bounds,t=this.getTopLeftCorner(),i=this.getTopRightCorner(),o=this.getBottomLeftCorner(),n=this.getBottomRightCorner();return e.addPoint(new PIXI.Point(t.x,t.y)),e.addPoint(new PIXI.Point(i.x,i.y)),e.addPoint(new PIXI.Point(o.x,o.y)),e.addPoint(new PIXI.Point(n.x,n.y)),e.getRectangle()}contains(e){const t=e.getBounds(!0);return t.right>0&&t.left<this.width*this.scale.x&&t.bottom>0&&t.top<this.width*this.scale.y}realign(e){if(!e.isUi)throw console.error("[ct.camera] An attempt to realing a room that is not in UI space. The room in question is",e),new Error("[ct.camera] An attempt to realing a room that is not in UI space.");const t=$e.templates[e.name].width||1,i=$e.templates[e.name].height||1;for(const o of e.children)at in o&&(o.skipRealign||(o.x=o.xstart/t*this.width,o.y=o.ystart/i*this.height))}manageStage(){const e=this.computedX,t=this.computedY,i=1/(isNaN(this.scale.x)?1:this.scale.x),o=1/(isNaN(this.scale.y)?1:this.scale.y);for(const n of lt.stage.children)"isUi"in n&&n.isUi||!n.pivot||(n.x=-this.width/2,n.y=-this.height/2,n.pivot.x=e,n.pivot.y=t,n.scale.x=i,n.scale.y=o,n.angle=-this.angle)}};Pe=new WeakMap,Me=new WeakMap;var Fe=new Re(0,0,720,1280),Ke=function(e,t){let i="The parameter ";throw e&&(i+=`${e} `),t&&(i+=`of ${t} `),i+="is required.",new Error(i)},Ye={delta:1,deltaUi:1,time:1/60,timeUi:1/60,timeUI:1/60,getEnvironment(){if("ct.js debugger"===window.name)return"ct.ide";try{if("nw"in window&&"require"in window.nw)return"nw"}catch(e){}try{return c("electron"),"electron"}catch(e){}return"browser"},getOS(){const e=window.navigator.userAgent;return-1!==e.indexOf("Windows")?"windows":-1!==e.indexOf("Linux")?"linux":-1!==e.indexOf("Mac")?"darwin":"unknown"},ldx:(e,t)=>e*Math.cos(t*Math.PI/180),ldy:(e,t)=>e*Math.sin(t*Math.PI/180),pdn:(e,t,i,o)=>(180*Math.atan2(o-t,i-e)/Math.PI+360)%360,pdc:(e,t,i,o)=>Math.sqrt((i-e)*(i-e)+(o-t)*(o-t)),degToRad:e=>e*Math.PI/180,radToDeg:e=>e/Math.PI*180,rotate:(e,t,i)=>Ye.rotateRad(e,t,Ye.degToRad(i)),rotateRad(e,t,i){const o=Math.sin(i),n=Math.cos(i);return new PIXI.Point(n*e-o*t,n*t+o*e)},deltaDir(e,t){var i=(t=(t%360+360)%360)-(e=(e%360+360)%360);return i>180&&(i-=360),i<-180&&(i+=360),i},clamp:(e,t,i)=>Math.max(e,Math.min(i,t)),lerp:(e,t,i)=>e+(t-e)*i,unlerp:(e,t,i)=>(i-e)/(t-e),map:(e,t,i,o,n)=>(e-t)*(n-o)/(i-t)+o,hexToPixi:e=>Number("0x"+e.slice(1)),pixiToHex:e=>"#"+e.toString(16).padStart(6,"0"),getRectShape:e=>({type:"rect",left:e.width*e.anchor.x,top:e.height*e.anchor.y,right:e.width*(1-e.anchor.x),bottom:e.height*(1-e.anchor.y)}),reshapeNinePatch(e){const t="NineSlicePlane"===e.baseClass?e:e.panel,i=t.texture,o=i.shape,n=i.width,s=i.height,r=t.width-n,a=t.height-s,l=n-t.leftWidth-t.rightWidth,h=s-t.topHeight-t.bottomHeight;if("circle"===o.type)throw new Error(`[u.reshapeNinePatch] Cannot reshape a circular collision mask for ${e.template}. Please use a different collision type for its texture.`);if("rect"===o.type){const i={type:"rect",left:o.left,top:o.top,right:o.right+r,bottom:o.bottom+a};return o.left>t.leftWidth&&(i.left=(o.left-t.leftWidth)*(1+r)/l),o.right<t.rightWidth&&(i.right=(o.right-t.rightWidth)*(1+r)/l),o.top>t.topHeight&&(i.top=(o.top-t.topHeight)*(1+a)/h),o.bottom<t.bottomHeight&&(i.bottom=(o.bottom-t.bottomHeight)*(1+a)/h),void(e.shape=i)}if("strip"===o.type){const i={type:"strip",points:[],closedStrip:o.closedStrip};i.points=o.points.map((e=>{let{x:i,y:o}=e;return e.x>=n-t.rightWidth?i+=r:e.x>t.leftWidth&&(i=t.leftWidth+(e.x-t.leftWidth)*(1+r/l)),e.y>=s-t.bottomHeight?o+=a:e.y>t.topHeight&&(o=t.topHeight+(e.y-t.topHeight)*(1+a/h)),{x:i,y:o}})),e.shape=i}const c=Ye.getHitArea(e.shape);c&&(e.hitArea=c)},getHitArea:e=>"circle"===e.type?new PIXI.Circle(0,0,e.r):"rect"===e.type?new PIXI.Rectangle(-e.left,-e.top,e.left+e.right,e.top+e.bottom):"strip"===e.type&&new PIXI.Polygon(e.points.map((e=>new PIXI.Point(e.x,e.y)))),prect(e,t,i){var o,n,s,r;if(i instanceof Array)o=Math.min(i[0],i[2]),n=Math.max(i[0],i[2]),s=Math.min(i[1],i[3]),r=Math.max(i[1],i[3]);else{if("rect"!==i.shape.type)throw new Error("[ct.u.prect] The specified copy doesn't have a rectangular collision shape.");o=i.x-i.shape.left*i.scale.x,n=i.x+i.shape.right*i.scale.x,s=i.y-i.shape.top*i.scale.y,r=i.y+i.shape.bottom*i.scale.y}return e>=o&&t>=s&&e<=n&&t<=r},pcircle(e,t,i){if(i instanceof Array)return Ye.pdc(e,t,i[0],i[1])<i[2];if("circle"!==i.shape.type)throw new Error("[ct.u.pcircle] The specified copy doesn't have a circular shape");return Ye.pdc(0,0,(i.x-e)/i.scale.x,(i.y-t)/i.scale.y)<i.shape.r},uiToCssCoord(e,t){const i=Je;return new PIXI.Point(e/Fe.width*i.width+i.x,t/Fe.height*i.height+i.y)},gameToCssCoord(e,t){const i=Fe.gameToUiCoord(e,t);return Ye.uiToCssCoord(i.x,i.y)},uiToCssScalar:e=>e/Fe.width*Je.width,gameToCssScalar:e=>e/(Fe.width*Fe.scale.x)*Je.width,gameToUiCoord:(e,t)=>Fe.gameToUiCoord(e,t),uiToGameCoord:(e,t)=>Fe.uiToGameCoord(e,t),wait:e=>M.add(e),waitUi:e=>M.addUi(e),promisify:e=>function(...t){return new Promise(((i,o)=>{t.push((function(e,t){e?o(e):i(t)})),e.call(this,...t)}))},required:Ke,numberedString:(e,t)=>e+"_"+t.toString().padStart(2,"0"),getStringNumber:e=>Number(e.split("_").pop())};Object.assign(Ye,{getOs:Ye.getOS,lengthDirX:Ye.ldx,lengthDirY:Ye.ldy,pointDirection:Ye.pdn,pointDistance:Ye.pdc,pointRectangle:Ye.prect,pointCircle:Ye.pcircle});var Ge,Ue=Ye,je=class extends PIXI.Container{constructor(e,t){if(super(),this.alignElements=[],this.kill=!1,this.tileLayers=[],this.backgrounds=[],this.bindings=new Set,this.tickerSet=new Set,this.timer1=0,this.timer2=0,this.timer3=0,this.timer4=0,this.timer5=0,this.timer6=0,this.x=this.y=0,this.sortableChildren=!0,this.uid=je.getNewId(),e){this.onCreate=e.onCreate,this.onStep=e.onStep,this.onDraw=e.onDraw,this.onLeave=e.onLeave,this.template=e,this.name=e.name,this.isUi=e.isUi,this.follow=e.follow,this.viewWidth=e.width,this.viewHeight=e.height,this.behaviors=[...e.behaviors],e.extends&&Object.assign(this,e.extends),t&&(He.current=this,lt.renderer.background.color=Ue.hexToPixi(this.template.backgroundColor)),this===rooms.current&&(yt.tileGrid={}),this===rooms.current&&(rooms.current.matterEngine=Matter.Engine.create(),rooms.current.matterWorld=rooms.current.matterEngine.world,rooms.current.matterGravity=rooms.current.matterGravity||[0,9.8],[rooms.current.matterWorld.gravity.x,rooms.current.matterWorld.gravity.y]=rooms.current.matterGravity,matter.rulebookStart=[],matter.rulebookActive=[],matter.rulebookEnd=[]);for(let t=0,i=e.bgs.length;t<i;t++){const i=new z(e.bgs[t].texture,null,e.bgs[t].depth,e.bgs[t].exts);this.addChild(i)}for(let t=0,i=e.tiles.length;t<i;t++){const i=new Z(e.tiles[t]);this.tileLayers.push(i),this.addChild(i)}for(let t=0,i=e.objects.length;t<i;t++){const i=e.objects[t],o=i.exts||{},n=i.customProperties||{},s=_e.copyIntoRoom(i.template,i.x,i.y,this,h(l(l({},o),n),{scaleX:i.scale.x,scaleY:i.scale.y,rotation:i.rotation,alpha:i.opacity,tint:i.tint,customSize:i.customSize,customWordWrap:i.customWordWrap,customText:i.customText,customAnchor:i.customAnchor,align:i.align}));i.align&&this.alignElements.push(s),e.bindings[t]&&this.bindings.add(e.bindings[t].bind(s))}this.alignElements.length&&this.realignElements(e.width,e.height,Fe.width,Fe.height)}else this.behaviors=[];return this}static getNewId(){return this.roomId++,this.roomId}realignElements(e,t,i,o){for(const n of this.alignElements){if(!n.align)continue;const{padding:s,frame:r}=n.align,a=e*r.x1/100+s.left,l=t*r.y1/100+s.top,h=e*(r.x2-r.x1)/100-s.left-s.right,c=t*(r.y2-r.y1)/100-s.top-s.bottom,d=i*r.x1/100+s.left,p=o*r.y1/100+s.top,u=i*(r.x2-r.x1)/100-s.left-s.right,m=o*(r.y2-r.y1)/100-s.top-s.bottom;if(e!==i)switch(n.align.alignX){case"start":n.x+=d-a;break;case"both":n.x+=d-a,n.width+=u-h;break;case"end":n.x+=u-h+d-a;break;case"center":n.x+=(u-h)/2+d-a;break;case"scale":{const e=u/h||1;n.width*=e,n.x=(n.x-a)*e+d}}if(t!==o)switch(n.align.alignY){case"start":n.y+=p-l;break;case"both":n.y+=p-l,n.height+=m-c;break;case"end":n.y+=m-c+p-l;break;case"center":n.y+=(m-c)/2+p-l;break;case"scale":{const e=m/c||1;n.height*=e,n.y=(n.y-l)*e+p}}}}get x(){return-this.position.x}set x(e){this.position.x=-e}get y(){return-this.position.y}set y(e){this.position.y=-e}},We=je;We.roomId=0,We.roomId=0;var He={templates:{},Room:We,current:null,list:{},addBg(e,t){const i=new z(e,null,t);return He.current.addChild(i),i},clear(){lt.stage.children.length=0,mt.length=0;for(const e in _e.list)_e.list[e]=[];for(const e in V.list)V.list[e]=[];He.list={};for(const e in He.templates)He.list[e]=[]},remove(e){if(!(e instanceof We)){if("string"==typeof e)throw console.error("[rooms.remove] To remove a room, you should provide a reference to it (to an object), not its name. Provided value:",e),new Error("[rooms.remove] Invalid argument type");throw new Error("[rooms] An attempt to remove a room that is not actually a room! Provided value:"+e)}const t=He.list[e.name].indexOf(e);-1!==t?He.list[e.name].splice(t,1):console.warn("[rooms] Removing a room that was not found in rooms.list. This is strange…"),e.kill=!0,lt.stage.removeChild(e);for(const t of e.children)at in t&&(t.kill=!0);e.onLeave(),He.onLeave.apply(e)},switch(e){He.templates[e]?(Ge=e,He.switching=!0):console.error('[rooms] The room "'+e+'" does not exist!')},switching:!1,restart(){He.switch(He.current.name)},append(e,t){if(!(e in He.templates))throw new Error(`[rooms.append] append failed: the room ${e} does not exist!`);const i=new We(He.templates[e],!1);return t&&Object.assign(i,t),lt.stage.addChild(i),i.onCreate.apply(i),He.onCreate.apply(i),He.list[e].push(i),i},prepend(e,t){if(!(e in He.templates))throw new Error(`[rooms] prepend failed: the room ${e} does not exist!`);const i=new We(He.templates[e],!1);return t&&Object.assign(i,t),lt.stage.addChildAt(i,0),i.onCreate.apply(i),He.onCreate.apply(i),He.list[e].push(i),i},merge(e){var t,i;if(!(e in He.templates))return console.error(`[rooms] merge failed: the room ${e} does not exist!`),!1;const o={copies:[],tileLayers:[],backgrounds:[]},n=He.templates[e],s=He.current;for(const e of n.bgs){const t=new z(e.texture,null,e.depth,e.exts);s.backgrounds.push(t),s.addChild(t),o.backgrounds.push(t)}for(const e of n.tiles){const t=new Z(e);s.tileLayers.push(t),s.addChild(t),o.tileLayers.push(t)}for(const e of n.objects){const n=_e.copyIntoRoom(e.template,e.x,e.y,s,l({tx:e.scale.x||1,ty:e.scale.y||1,tr:e.rotation||0,scaleX:null==(t=e.scale)?void 0:t.x,scaleY:null==(i=e.scale)?void 0:i.y,rotation:e.rotation,alpha:e.opacity},e.customProperties));o.copies.push(n)}return o},forceSwitch(e){Ge&&(e=Ge),He.current&&(He.rootRoomOnLeave.apply(He.current),He.current.onLeave(),He.onLeave.apply(He.current),He.current=void 0),He.clear(),rt.length=0;var t=He.templates[e];Fe.reset(t.width/2,t.height/2,t.width,t.height),t.cameraConstraints&&(Fe.minX=t.cameraConstraints.x1,Fe.maxX=t.cameraConstraints.x2,Fe.minY=t.cameraConstraints.y1,Fe.maxY=t.cameraConstraints.y2),He.current=new We(t,!0),lt.stage.addChild(He.current),ze(),He.rootRoomOnCreate.apply(He.current),He.current.onCreate(),He.onCreate.apply(He.current),He.list[e].push(He.current),Fe.manageStage(),He.switching=!1,Ge=void 0},onCreate(){if(this===rooms.current){const e=new PIXI.Graphics;e.depth=1e7,rooms.current.addChild(e),yt.debugTraceGraphics=e}for(const e of this.tileLayers)-1!==this.children.indexOf(e)&&yt.enableTilemapCollisions(e);this===rooms.current&&(matter.on("collisionStart",(e=>{const{pairs:t}=e;matter.walkOverWithRulebook(matter.rulebookStart,t)})),matter.on("collisionActive",(e=>{const{pairs:t}=e;matter.walkOverWithRulebook(matter.rulebookActive,t)})),matter.on("collisionEnd",(e=>{const{pairs:t}=e;matter.walkOverWithRulebook(matter.rulebookEnd,t)})));for(const e of this.tileLayers)e.matterMakeStatic&&-1!==this.children.indexOf(e)&&matter.createStaticTilemap(e);this.behaviors.length&&ie(this,"rooms","thisOnCreate")},onLeave(){if(this===rooms.current&&(yt.grid={}),!this.kill){for(const e of tween.tweens)e.reject({info:"Room switch",code:1,from:"tween"});tween.tweens=[]}this.behaviors.length&&ie(this,"rooms","thisOnDestroy")},beforeStep(){ft.updateGestures();{const e=camera.uiToGameCoord(ft.xui,ft.yui);ft.x=e.x,ft.y=e.y}{let e=0;for(;e<tween.tweens.length;){const t=tween.tweens[e];if(t.obj.kill){t.reject({code:2,info:"Copy is killed"}),tween.tweens.splice(e,1);continue}let i=1e3*t.timer.time/t.duration;i>1&&(i=1);for(const e in t.fields){const o=t.starting[e],n=t.fields[e]-t.starting[e];t.obj[e]=t.curve(o,n,i)}1!==i?e++:(t.resolve(t.fields),tween.tweens.splice(e,1))}}},afterStep(){this.behaviors.length&&ie(this,"rooms","thisOnStep");for(const e of this.tickerSet)e.tick()},beforeDraw(){this===rooms.current&&Matter.Engine.update(rooms.current.matterEngine,1e3/ut.maxFPS)},afterDraw(){for(const e of ft.down)e.xprev=e.x,e.yprev=e.y,e.xuiprev=e.x,e.yuiprev=e.y;for(const e of ft.hover)e.xprev=e.x,e.yprev=e.y,e.xuiprev=e.x,e.yuiprev=e.y;inputs.registry["pointer.Wheel"]=0,ft.clearReleased(),ft.xmovement=ft.ymovement=0,gt.clear(),this.behaviors.length&&ie(this,"rooms","thisOnDraw");for(const e of this.bindings)e()},rootRoomOnCreate(){},rootRoomOnStep(){},rootRoomOnDraw(){},rootRoomOnLeave(){},starting:"Mechanics"},$e=He;document.body.style.overflow="hidden";var Je={x:0,y:0,width:0,height:0},ze=()=>{const e=ut.viewMode;let t=ut.highDensity&&window.devicePixelRatio||1;"fastScale"!==e&&"fastScaleInteger"!==e||(t=1);const i=window.innerWidth/$e.current.viewWidth,o=window.innerHeight/$e.current.viewHeight;let n=Math.min(i,o);var s,r,a,l;if("fastScaleInteger"===e&&(n=n<1?n:Math.floor(n)),"expand"===e?(s=Math.ceil(window.innerWidth*t),r=Math.ceil(window.innerHeight*t),a=window.innerWidth,l=window.innerHeight):"scaleFit"===e||"scaleFill"===e?"scaleFill"===e?(s=Math.ceil($e.current.viewWidth*i*t),r=Math.ceil($e.current.viewHeight*o*t),a=window.innerWidth/n,l=window.innerHeight/n):(s=Math.ceil($e.current.viewWidth*n*t),r=Math.ceil($e.current.viewHeight*n*t),a=$e.current.viewWidth,l=$e.current.viewHeight):(a=s=$e.current.viewWidth,l=r=$e.current.viewHeight),lt.renderer.resize(s,r),lt.stage.scale.x=lt.stage.scale.y="scaleFill"!==e&&"scaleFit"!==e?"fastScale"===e||"fastScaleInteger"===e?1:t:t*n,lt.view.style.width=Math.ceil(s/t)+"px",lt.view.style.height=Math.ceil(r/t)+"px",Fe){const e=Fe.width,t=Fe.height;Fe.width=a,Fe.height=l;for(const i of lt.stage.children)i instanceof We&&i.realignElements(e,t,a,l)}!function(e,t){const i=lt.view;"fastScale"===e||"fastScaleInteger"===e?(i.style.transform=`translate(-50%, -50%) scale(${t})`,i.style.position="absolute",i.style.top="50%",i.style.left="50%"):"expand"===e||"scaleFill"===e?(i.style.transform="",i.style.position="static",i.style.top="unset",i.style.left="unset"):"scaleFit"===e?(i.style.transform="translate(-50%, -50%)",i.style.position="absolute",i.style.top="50%",i.style.left="50%"):i.style.transform=i.style.position=i.style.top=i.style.left="";const o=i.getBoundingClientRect();Je.x=o.left,Je.y=o.top,Je.width=o.width,Je.height=o.height}(e,n)};window.addEventListener("resize",ze);var Ve=function(){try{return c("electron").remote.BrowserWindow.getFocusedWindow.isFullScreen}catch(e){}return Boolean(document.fullscreenElement)},qe={},Qe=class{constructor(e){return this.methodCodes=[],this.methodMultipliers=[],this.prevValue=0,this.value=0,this.name=e,this}methodExists(e){return-1!==this.methodCodes.indexOf(e)}addMethod(e,t){if(-1!==this.methodCodes.indexOf(e))throw new Error(`[ct.inputs] An attempt to add an already added input "${e}" to an action "${this.name}".`);this.methodCodes.push(e),this.methodMultipliers.push(void 0!==t?t:1)}removeMethod(e){const t=this.methodCodes.indexOf(e);-1!==t&&(this.methodCodes.splice(t,1),this.methodMultipliers.splice(t,1))}setMultiplier(e,t){const i=this.methodCodes.indexOf(e);-1!==i?this.methodMultipliers[i]=t:(console.warn(`[ct.inputs] An attempt to change multiplier of a non-existent method "${e}" at event ${this.name}`),console.trace())}update(){this.prevValue=this.value,this.value=0;for(let e=0,t=this.methodCodes.length;e<t;e++){const t=qe[this.methodCodes[e]]||0;this.value+=t*this.methodMultipliers[e]}return this.value=Math.max(-1,Math.min(this.value,1)),this.value}reset(){this.prevValue=this.value=0}get pressed(){return 0===this.prevValue&&0!==this.value}get released(){return 0!==this.prevValue&&0===this.value}get down(){return 0!==this.value}},Ze={},et={registry:qe,addAction(e,t){if(e in Ze)throw new Error(`[ct.inputs] An action "${e}" already exists, can't add a new one with the same name.`);const i=new Qe(e);for(const e of t)i.addMethod(e.code,e.multiplier);return Ze[e]=i,i},removeAction(e){delete Ze[e]},updateActions(){for(const e in Ze)Ze[e].update()}},tt=JSON.parse("{}");PIXI.particles.Particle.prototype.isInteractive=()=>!1;{const e=(e,t)=>{let i;return t||(t={}),"#"===e.charAt(0)?e=e.substr(1):0===e.indexOf("0x")&&(e=e.substr(2)),8===e.length&&(i=e.substr(0,2),e=e.substr(2)),t.r=parseInt(e.substr(0,2),16),t.g=parseInt(e.substr(2,2),16),t.b=parseInt(e.substr(4,2),16),i&&(t.a=parseInt(i,16)),t};PIXI.particles.PropertyNode.createList=t=>{const i=t.list;let o;const{value:n,time:s}=i[0],r=o=new PIXI.particles.PropertyNode("string"==typeof n?e(n):n,s,t.ease);if(i.length>1)for(let t=1;t<i.length;++t){const{value:n,time:s}=i[t];o.next=new PIXI.particles.PropertyNode("string"==typeof n?e(n):n,s),o=o.next}return r.isStepped=Boolean(t.isStepped),r}}var it=class extends PIXI.Container{constructor(e,t){super(),this.frozen=!1,this.stopped=!1,this.kill=!1,this.isUi=!1,this.emitters=[],this.delayed=[];for(const i of e){let{settings:e}=i;if(e=h(l({},e),{behaviors:structuredClone(e.behaviors)}),t.tint){const i=new PIXI.Color(t.tint);e.behaviors[1].config.color.list.forEach((e=>{e.value=new PIXI.Color(e.value).multiply(i).toHex().slice(1)}))}const o=$.getTexture(i.texture);"textureRandom"===i.textureBehavior?e.behaviors.push({type:"textureRandom",config:{textures:o}}):e.behaviors.push({type:"animatedSingle",config:{anim:{framerate:i.animatedSingleFramerate,loop:!0,textures:o}}});const n=new PIXI.particles.Emitter(this,e),s=i.settings.delay+t.prewarmDelay;s>0?(n.emit=!1,this.delayed.push({value:s,emitter:n})):s<0?(n.emit=!0,n.update(-s)):n.emit=!0,n.initialDeltaPos={x:i.settings.pos.x,y:i.settings.pos.y},this.emitters.push(n),n.playOnce((()=>{this.emitters.splice(this.emitters.indexOf(n),1)}))}this.isUi=t.isUi,this.scale.x=t.scale.x,this.scale.y=t.scale.y,t.rotation?this.rotation=t.rotation:t.angle&&(this.angle=t.angle),this.deltaPosition=t.position,this.zIndex=t.depth,this.frozen=!1,this.isUi?nt.uiTandems.push(this):nt.tandems.push(this)}update(){if(this.stopped)for(const e of this.emitters)e.particleCount||this.emitters.splice(this.emitters.indexOf(e),1);if(this.appendant&&this.appendant.destroyed||this.kill||!this.emitters.length)return this.emit("done"),this.isUi?nt.uiTandems.splice(nt.uiTandems.indexOf(this),1):nt.tandems.splice(nt.tandems.indexOf(this),1),void this.destroy();if(this.frozen)return;const e=(this.isUi?PIXI.Ticker.shared.elapsedMS:PIXI.Ticker.shared.deltaMS)/1e3;for(const t of this.delayed)t.value-=e,t.value<=0&&(t.emitter.emit=!0,this.delayed.splice(this.delayed.indexOf(t),1));for(const t of this.emitters)this.delayed.find((e=>e.emitter===t))||t.update(e);this.follow&&this.updateFollow()}stop(){if(this.stopped)console.trace("[emitters] An attempt to stop an already stopped emitter tandem. Continuing…");else{this.stopped=!0;for(const e of this.emitters)e.emit=!1;this.delayed=[]}}pause(){for(const e of this.emitters)0!==e.maxParticles&&(e.oldMaxParticles=e.maxParticles,e.maxParticles=0)}resume(){for(const e of this.emitters)e.maxParticles=e.oldMaxParticles||e.maxParticles}clear(){for(const e of this.emitters)e.cleanup()}updateFollow(){if(!this.follow)return;if("kill"in this.follow&&this.follow.kill||!this.follow.scale)return this.follow=null,void this.stop();const e=Ue.rotate(this.deltaPosition.x*this.follow.scale.x,this.deltaPosition.y*this.follow.scale.y,this.follow.angle);for(const t of this.emitters){t.updateOwnerPos(this.follow.x+e.x,this.follow.y+e.y);const i=Ue.rotate(t.initialDeltaPos.x*this.follow.scale.x,t.initialDeltaPos.y*this.follow.scale.y,this.follow.angle);t.updateSpawnPos(i.x,i.y)}}},ot={prewarmDelay:0,scale:{x:1,y:1},tint:16777215,alpha:1,position:{x:0,y:0},isUi:!1,depth:1/0},nt={templates:{}||{},uiTandems:[],tandems:[],fire(e,t,i,o){if(!(e in nt.templates))throw new Error(`[emitters] An attempt to create a non-existent emitter ${e}.`);const n=Object.assign({},ot,o),s=new it(nt.templates[e],n);return s.x=t,s.y=i,n.room?(n.room.addChild(s),s.isUi=n.room.isUi):($e.current.addChild(s),s.isUi=$e.current.isUi),s},append(e,t,i){if(!(t in nt.templates))throw new Error(`[emitters] An attempt to create a non-existent emitter ${t}.`);if(!(e instanceof PIXI.Container))throw new Error("[emitters] Cannot attach an emitter as the specified parent cannot have child elements.");const o=Object.assign({},ot,i),n=new it(nt.templates[t],o);if(o.position&&(n.x=o.position.x,n.y=o.position.y),n.appendant=e,!("addChild"in e))throw console.error(e),new Error("[emitters] An attempt to append an emitter to an entity that doesn't support children.");return e.addChild(n),n},follow(e,t,i){if(!(t in nt.templates))throw new Error(`[emitters] An attempt to create a non-existent emitter ${t}.`);const o=Object.assign({},ot,i),n=new it(nt.templates[t],o);return n.follow=e,n.updateFollow(),"getRoom"in e?e.getRoom().addChild(n):$e.current.addChild(n),n}};PIXI.Ticker.shared.add((()=>{for(const e of nt.uiTandems)e.update();for(const e of nt.tandems)e.update()}));var st=nt;
/*! Made with ct.js http://ctjs.rocks/ */
console.log("%c 😺 %c ct.js game editor %c v4.0.2 %c https://ctjs.rocks/ ","background: #446adb; color: #fff; padding: 0.5em 0;","background: #5144db; color: #fff; padding: 0.5em 0;","background: #446adb; color: #fff; padding: 0.5em 0;","background: #5144db; color: #fff; padding: 0.5em 0;");try{c("electron")}catch(e){try{c("electron/main")}catch(e){"file:"===location.protocol&&alert("Your game won't work like this because\nWeb 👏 builds 👏 require 👏 a web 👏 server!\n\nConsider using a desktop build, or upload your web build to itch.io, GameJolt or your own website.\n\nIf you haven't created this game, please contact the developer about this issue.\n\n Also note that ct.js games do not work inside the itch app; you will need to open the game with your browser of choice.")}}"NL_OS"in window&&(Neutralino.init(),Neutralino.events.on("windowClose",(()=>{Neutralino.app.exit()})));var rt=[],at=Symbol("I am a ct.js copy");setInterval((function(){rt.length=0}),6e4);var lt,ht,ct={name:"NAN",author:"PrimatePlay Studio",site:"",version:"0.0.0"},dt="scaleFill",pt=Boolean(!0),ut={get highDensity(){return pt},set highDensity(e){pt=e,PIXI.settings.RESOLUTION=pt?window.devicePixelRatio:1,$e.current&&ze()},get targetFps(){return lt.ticker.maxFPS},set targetFps(e){lt.ticker.maxFPS=e},get viewMode(){return dt},set viewMode(e){dt=e,ze()},get fullscreen(){return Ve()},set fullscreen(e){Ve()!==e&&function(){try{const e=c("electron").remote.BrowserWindow.getFocusedWindow();return void e.setFullScreen(!e.isFullScreen())}catch(e){}const e=document.fullscreenElement,t=document.getElementById("ct");if(e)document.exitFullscreen();else{var i=t.requestFullscreen();i&&i.catch((function(e){console.error("[fittoscreen]",e)}))}}()},get pixelart(){return!1},preventDefault:!0},mt=[];{const e={width:720,height:1280,antialias:!0,powerPreference:"high-performance",autoDensity:!1,sharedTicker:!1,backgroundAlpha:0};PIXI.settings.RESOLUTION=1;try{lt=new PIXI.Application(e)}catch(t){console.error(t),console.warn("[ct.js] Something bad has just happened. This is usually due to hardware problems. I'll try to fix them now, but if the game still doesn't run, try including a legacy renderer in the project's settings."),PIXI.settings.SPRITE_MAX_TEXTURES=Math.min(PIXI.settings.SPRITE_MAX_TEXTURES,16),lt=new PIXI.Application(e)}PIXI.settings.ROUND_PIXELS=!1,lt.renderer.options.antialias||(PIXI.settings.SCALE_MODE=PIXI.SCALE_MODES.NEAREST),ut.targetFps=60,document.getElementById("ct").appendChild(lt.view)}{const e=t=>{t.kill=!0,_e.isCopy(t)&&t.onDestroy&&(_e.onDestroy.apply(t),t.onDestroy.apply(t));for(const i of t.children)_e.isCopy(i)&&e(i);const i=mt.indexOf(t);if(-1!==i&&mt.splice(i,1),_e.isCopy(t)&&t.template){const e=_e.list[t.template].indexOf(t);-1!==e&&_e.list[t.template].splice(e,1)}rt.push(t)},t=()=>{Fe.update(Ue.timeUi),Fe.manageStage()},i=()=>{const{ticker:i}=lt;Ue.delta=i.deltaMS/(1e3/(ut.targetFps||60)),Ue.deltaUi=i.elapsedMS/(1e3/(ut.targetFps||60)),Ue.time=i.deltaMS/1e3,Ue.timeUi=Ue.timeUI=i.elapsedMS/1e3,et.updateActions(),M.updateTimers(),yt.debugTraceGraphics.clear(),$e.rootRoomOnStep.apply($e.current);for(let e=0,t=mt.length;e<t;e++)_e.isCopy(mt[e])&&_e.beforeStep.apply(mt[e]),mt[e].onStep.apply(mt[e]),_e.isCopy(mt[e])&&_e.afterStep.apply(mt[e]);for(const e of lt.stage.children)e instanceof We&&($e.beforeStep.apply(e),e.onStep.apply(e),$e.afterStep.apply(e));for(const t of mt)t.kill&&!t._destroyed&&(e(t),t.destroy({children:!0}));t();for(let e=0,t=mt.length;e<t;e++)_e.isCopy(mt[e])&&_e.beforeDraw.apply(mt[e]),mt[e].onDraw.apply(mt[e]),_e.isCopy(mt[e])&&_e.afterDraw.apply(mt[e]),mt[e].xprev=mt[e].x,mt[e].yprev=mt[e].y;for(const e of lt.stage.children)e instanceof We&&($e.beforeDraw.apply(e),e.onDraw.apply(e),$e.afterDraw.apply(e));$e.rootRoomOnDraw.apply($e.current),$e.switching&&$e.forceSwitch()};(ht=$.loadGame()).then((()=>{setTimeout((()=>{lt.ticker.add(i),$e.forceSwitch($e.starting)}),0)}))}window.PIXI=PIXI;{const e=Ze,t=V,i=oe,o=Fe,n=tt,s=st,r=et,a=$,l=$e,h={},c=_,d=se,p=_e,u=ee,m=M,y=Ue;Object.assign(window,{actions:e,backgrounds:t,behaviors:i,Camera:Re,camera:o,CtAction:Qe,content:n,emitters:s,inputs:r,res:a,rooms:l,scripts:h,sounds:c,styles:d,templates:p,Tilemap:Z,tilemaps:u,timer:m,u:y,meta:ct,settings:ut,pixiApp:lt}),ht.then((()=>{ft.setupListeners()})),d.new("Geist-Regular",{fontFamily:'"CTPROJFONTGeist-Regular", "Geist-Regular", sans-serif',fontSize:24,fontStyle:"normal",fontWeight:"400",lineJoin:"round",lineHeight:32.400000000000006}),d.new("RG-Bold",{fontFamily:'"CTPROJFONTRidley Grotesk Bold", "Ridley Grotesk Bold", sans-serif',fontSize:24,fontStyle:"normal",fontWeight:"400",align:"center",lineJoin:"round",lineHeight:32.400000000000006,fill:"#FFFFFF"}),d.new("TD-Bold",{fontFamily:'"CTPROJFONTTrade Gothic LT Bold", "Trade Gothic LT Bold", sans-serif',fontSize:24,fontStyle:"normal",fontWeight:"400",lineJoin:"round",lineHeight:32.400000000000006,fill:"#FFFFFF"}),d.new("RG-Bold_Big",{fontFamily:'"CTPROJFONTRidley Grotesk Bold", "Ridley Grotesk Bold", sans-serif',fontSize:72,fontStyle:"normal",fontWeight:"400",align:"center",lineJoin:"round",lineHeight:97.2,fill:"#FFFFFF"}),d.new("RG-Bold_Green",{fontFamily:'"CTPROJFONTRidley Grotesk Bold", "Ridley Grotesk Bold", sans-serif',fontSize:24,fontStyle:"normal",fontWeight:"400",align:"center",lineJoin:"round",lineHeight:32.400000000000006,fill:"#46AF5F"}),d.new("RG-Bold_Blue",{fontFamily:'"CTPROJFONTRidley Grotesk Bold", "Ridley Grotesk Bold", sans-serif',fontSize:24,fontStyle:"normal",fontWeight:"400",align:"center",lineJoin:"round",lineHeight:32.400000000000006,fill:"#153B90"}),d.new("RG-Bold_BigGreen",{fontFamily:'"CTPROJFONTRidley Grotesk Bold", "Ridley Grotesk Bold", sans-serif',fontSize:72,fontStyle:"normal",fontWeight:"400",align:"center",lineJoin:"round",lineHeight:97.2,fill:"#46AF5F"}),d.new("RG-Bold_BigBlue",{fontFamily:'"CTPROJFONTRidley Grotesk Bold", "Ridley Grotesk Bold", sans-serif',fontSize:72,fontStyle:"normal",fontWeight:"400",align:"center",lineJoin:"round",lineHeight:97.2,fill:"#153B90"}),d.new("Geist-Regular_Blue",{fontFamily:'"CTPROJFONTGeist-Regular", "Geist-Regular", sans-serif',fontSize:40,fontStyle:"normal",fontWeight:"400",align:"center",lineJoin:"round",lineHeight:54,fill:"#153B90"}),p.templates.BLactis={name:"BLactis",depth:2,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"B.LACTIS_ORB",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){if(this.position.y<290&&!l.current.win){l.current.timer1=0,l.current.win=!0,l.current.timerLabel.text="00:00",l.current.timer1=0,ft.clear();var e=l.append("Try Again");e.alpha=0,tween.add({obj:e,fields:{alpha:1},duration:250,silent:!0}).then((()=>{this.kill=!0}))}},onDestroy:function(){},onCreate:function(){},extends:{matterEnable:!0,matterFriction:2,matterFrictionAir:.05}},p.list.BLactis=[],p.templates.BLactis_={name:"BLactis_",depth:2,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"B.LACTIS_ORB",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{matterEnable:!1,matterFriction:2,matterFrictionAir:.05}},p.list.BLactis_=[],p.templates.HMO={name:"HMO",depth:2,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"5HMO_COMPLEX_ORB",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){if(this.position.y<290&&!l.current.win){l.current.timer1=0,l.current.win=!0,l.current.timerLabel.text="00:00",l.current.timer1=0,ft.clear();var e=l.append("Try Again");e.alpha=0,tween.add({obj:e,fields:{alpha:1},duration:250,silent:!0}).then((()=>{this.kill=!0}))}},onDestroy:function(){},onCreate:function(){},extends:{matterEnable:!0,matterFriction:2,matterFrictionAir:.05}},p.list.HMO=[],p.templates.Protein={name:"Protein",depth:2,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"OPTIMIZED_PROTEIN_ORB",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){if(this.position.y<290&&!l.current.win){l.current.timer1=0,l.current.win=!0,l.current.timerLabel.text="00:00",l.current.timer1=0,ft.clear();var e=l.append("Try Again");e.alpha=0,tween.add({obj:e,fields:{alpha:1},duration:250,silent:!0}).then((()=>{this.kill=!0}))}},onDestroy:function(){},onCreate:function(){},extends:{matterEnable:!0,matterFriction:2,matterFrictionAir:.05}},p.list.Protein=[],p.templates.Protein_={name:"Protein_",depth:2,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"OPTIMIZED_PROTEIN_ORB",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{matterEnable:!1,matterFriction:2,matterFrictionAir:.05}},p.list.Protein_=[],p.templates.Sucrose={name:"Sucrose",depth:2,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"ZERO_SUCROSE_ORB",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){if(this.position.y<290&&!l.current.win){l.current.timer1=0,l.current.win=!0,l.current.timerLabel.text="00:00",l.current.timer1=0,ft.clear();var e=l.append("Try Again");e.alpha=0,tween.add({obj:e,fields:{alpha:1},duration:250,silent:!0}).then((()=>{this.kill=!0}))}},onDestroy:function(){},onCreate:function(){},extends:{matterEnable:!0,matterFriction:2,matterFrictionAir:.05}},p.list.Sucrose=[],p.templates.Sucrose_={name:"Sucrose_",depth:2,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"ZERO_SUCROSE_ORB",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{matterEnable:!1,matterFriction:2,matterFrictionAir:.05}},p.list.Sucrose_=[],p.templates.HMO_={name:"HMO_",depth:2,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"5HMO_COMPLEX_ORB",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{matterEnable:!1,matterFriction:2,matterFrictionAir:.05}},p.list.HMO_=[],p.templates.Brain={name:"Brain",depth:2,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"Brain",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{matterEnable:!1,matterFrictionAir:.05,cgroup:"Core"}},p.list.Brain=[],p.templates.Growth={name:"Growth",depth:2,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"Growth",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{matterEnable:!1,matterFrictionAir:.05,cgroup:"Core"}},p.list.Growth=[],p.templates.Immunity={name:"Immunity",depth:2,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"Immunity",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{matterEnable:!1,matterFrictionAir:.05,cgroup:"Core"}},p.list.Immunity=[],p.templates.Pro={name:"Pro",depth:5,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"NAN_GAME_5HMO_ORB",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{matterEnable:!0,matterFrictionAir:.005}},p.list.Pro=[],p.templates.Protection={name:"Protection",depth:2,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"Protection",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{matterEnable:!1,matterFrictionAir:.05,cgroup:"Core"}},p.list.Protection=[],p.templates.Digestion={name:"Digestion",depth:2,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"Digestion",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{matterEnable:!1,matterFrictionAir:.05,cgroup:"Core"}},p.list.Digestion=[],p.templates.Logo={name:"Logo",depth:60,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"NNI_HEADER-NAN_ACTIVITY-MSN_RESIDENTS_WORKSHOP",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},p.list.Logo=[],p.templates.Placeholder={name:"Placeholder",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"Placeholder",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},p.list.Placeholder=[],p.templates.Detailer={name:"Detailer",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"NAN_OPTIPRO_DETAILER_CARD_MOCKUP",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},p.list.Detailer=[],p.templates.Background={name:"Background",depth:1,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"NAN_GAME_BACKGROUND",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},p.list.Background=[],p.templates.Top={name:"Top",depth:1,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"NAN_GAME_ASSET–TOP_LINE",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},p.list.Top=[],p.templates.Ground={name:"Ground",depth:1,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"Detailer",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{matterEnable:!0,matterStatic:!0,matterConstraint:"none"}},p.list.Ground=[],p.templates.Core={name:"Core",depth:2,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"Core",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){if(this.position.y<300&&!l.current.win){l.current.timer1=0,l.current.win=!0,l.current.timerLabel.text="00:00",l.current.timer1=0,ft.clear();var e=l.append("Try Again");e.alpha=0,tween.add({obj:e,fields:{alpha:1},duration:250,silent:!0}).then((()=>{this.kill=!0}))}},onDestroy:function(){},onCreate:function(){this.current,this.brain=null,this.digestion=null,this.growth=null,this.immunity=null,this.protection=null},extends:{matterEnable:!0,matterFrictionAir:.05,matterSensor:!1,matterStatic:!1,cgroup:"Core",matterFriction:5}},p.list.Core=[],p.templates.Cursor={name:"Cursor",depth:5,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"NAN_GAME-HAND_ICON",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},p.list.Cursor=[],p.templates.Instruction={name:"Instruction",depth:10,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"ORB_MECHANICS",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},p.list.Instruction=[],p.templates.Mechanics1={name:"Mechanics1",depth:5,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"NAN_MECHANICS_LIGHTBOX",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){if(ft.collides(this)&&!this.pressed){this.pressed=!0;var e=p.copy("Mechanics2",this.position.x,this.position.y);l.current.addChild(e),e.scale.x=e.scale.y=.22855,this.kill=!0}},onDestroy:function(){},onCreate:function(){this.pressed=!1},extends:{}},p.list.Mechanics1=[],p.templates.Mechanics2={name:"Mechanics2",depth:4,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"NAN_GAME_MECHANICS_LIGHTBOX_PART_2",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){ft.collides(this)&&!this.pressed&&(ft.clear(),l.switch("Game"))},onDestroy:function(){},onCreate:function(){this.pressed=!1},extends:{}},p.list.Mechanics2=[],p.templates.Lightbox={name:"Lightbox",depth:10,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"Lightbox",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){ft.collides(this)&&(0==this.offset&&(this.offset=this.getRoom().scrollParent.position.y-ft.y),this.getRoom().scrollParent.position.y=Math.min(Math.max(ft.y+this.offset,this.getRoom().minY),this.getRoom().maxY)),ft.released[0]&&(this.offset=0)},onDestroy:function(){},onCreate:function(){this.offset=0},extends:{}},p.list.Lightbox=[],p.templates.ScrollParent={name:"ScrollParent",depth:11,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:-1,animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},p.list.ScrollParent=[],p.templates.CutBG={name:"CutBG",depth:13,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"CutBG",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},p.list.CutBG=[],p.templates.Detailer1={name:"Detailer1",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"NAN_DETAILER_VISUAL_1",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},p.list.Detailer1=[],p.templates.Detailer2={name:"Detailer2",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"NAN_DETAILER_VISUAL_2",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},p.list.Detailer2=[],p.templates.NANKIDLogo={name:"NANKIDLogo",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"NANKID_LOGO_NAN_DETAILER_EDIT",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},p.list.NANKIDLogo=[],p.templates.Black={name:"Black",depth:15,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"Black",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){ft.collides(this)&&!this.getRoom().pressed&&(this.getRoom().pressed=!0,tween.add({obj:l.current,fields:{alpha:0},duration:250,silent:!0}).then((()=>{l.switch("Game")})))},onDestroy:function(){},onCreate:function(){},extends:{}},p.list.Black=[],p.templates.Div={name:"Div",depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,visible:!0,baseClass:"AnimatedSprite",texture:"DETAILER_DIVIDER_LINE",animationFPS:30,playAnimationOnStart:!1,loopAnimation:!0,behaviors:JSON.parse("[]"),onStep:function(){},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},p.list.Div=[],l.templates.Game={name:"Game",width:720,height:1280,behaviors:JSON.parse("[]"),objects:JSON.parse('[{"x":360,"y":725,"opacity":1,"tint":13424096,"scale":{"x":1,"y":1},"rotation":0,"exts":{},"customProperties":{},"template":"Background"},{"x":798,"y":864,"opacity":0,"tint":16777215,"scale":{"x":5.0625,"y":19},"rotation":0,"exts":{},"customProperties":{},"template":"Ground"},{"x":360,"y":1285,"opacity":0,"tint":16777215,"scale":{"x":10.5,"y":5.84375},"rotation":0,"exts":{},"customProperties":{},"template":"Ground"},{"x":-87,"y":864,"opacity":0,"tint":16777215,"scale":{"x":5.28125,"y":19},"rotation":0,"exts":{},"customProperties":{},"template":"Ground"},{"x":358,"y":425,"opacity":1,"tint":16777215,"scale":{"x":0.225,"y":0.1},"rotation":0,"exts":{},"customProperties":{},"template":"Top"},{"x":360,"y":96,"opacity":1,"tint":16777215,"scale":{"x":0.2,"y":0.2},"rotation":0,"exts":{},"customProperties":{},"template":"Logo"},{"x":360,"y":1168,"opacity":1,"tint":16777215,"scale":{"x":0.225,"y":0.225},"rotation":0,"exts":{},"customProperties":{},"template":"Instruction"}]'),bgs:JSON.parse('[{"texture":"BG","depth":0,"exts":{"movementX":0,"movementY":0,"parallaxX":1,"parallaxY":1,"repeat":"no-repeat","scaleX":0.46,"scaleY":0.46,"shiftX":0,"shiftY":0}}]'),tiles:JSON.parse("[]"),backgroundColor:"#212121",onStep(){if(this.timer1>0&&this.timer1<=y.time){if(this.timer1=0,this.remainingTime--,this.remainingTime>=10&&this.remainingTime<60)this.timerLabel.text="00:"+this.remainingTime,this.timer1=1;else if(this.remainingTime<10&&this.remainingTime>0)this.timerLabel.text="00:0"+this.remainingTime,this.timer1=1;else if(this.remainingTime>=60)this.timerLabel.text="0"+Math.floor(this.remainingTime/60)+":"+(this.remainingTime>=70?this.remainingTime-60:"0"+(this.remainingTime-60)),this.timer1=1;else if(0==this.remainingTime){this.win=!0,console.log(this.remainingTime),this.timerLabel.text="00:00",this.timer1=0,ft.clear();var e=l.append("Try Again");e.alpha=0,tween.add({obj:e,fields:{alpha:1},duration:250})}}else this.timer1-=y.time;if(ft.down[0]&&!this.win){let e=Math.min(Math.max(ft.x,null!=this.currentOrb?this.minX+this.currentOrb.width/2:this.minX),null!=this.currentOrb?this.maxX-this.currentOrb.width/2:this.maxX);this.c.position.x=e,null!=this.currentOrb&&(this.currentOrb.x=this.c.x)}if(ft.released[0]&&null!=this.currentOrb&&!this.win){this.previousOrb=this.currentOrb,this.currentOrb.kill=!0,this.currentOrb=null;var t=this.previousOrb.template.slice(0,-1),i=p.copy(t,this.c.position.x,this.c.position.y);this.ingredients.push(i),y.wait(500).then((()=>{if(!this.win){this.currentOrb=p.copy(vt(),this.c.x,this.c.y);let e=Math.min(Math.max(this.c.x,null!=this.currentOrb?this.minX+this.currentOrb.width/2:this.minX),null!=this.currentOrb?this.maxX-this.currentOrb.width/2:this.maxX);this.c.x=e,this.currentOrb.x=this.c.x}}))}},onDraw(){},onLeave(){},onCreate(){{function e(){let e=[];for(let t=0;t<l.current.ingredients.length;t++)l.current.ingredients[t].kill||e.push(l.current.ingredients[t]);let t=[],i=[];for(let e=0;e<l.current.finalVariant.length;e++)t.includes(l.current.finalVariant[e].current)?i.push(l.current.finalVariant[e]):t.push(l.current.finalVariant[e].current);console.log(t);for(let t=0;t<e.length;t++)e[t].kill=!0;for(let e=0;e<i.length;e++)i[e].kill=!0;y.wait(4e3).then((()=>{!function(){let e=[];for(let t=0;t<l.current.finalVariant.length;t++)l.current.finalVariant[t].kill&&(null==l.current.finalVariant[t]||l.current.finalVariant[t].kill)||e.push(l.current.finalVariant[t]);for(let t=0;t<e.length;t++)e[t].kill=!0;this.p=p.copy("Pro",360,920),l.current.addChild(this.p),this.p.scale.x=this.p.scale.y=1,y.wait(2e3).then((()=>{let e=l.append("Detailer");e.alpha=0,tween.add({obj:e,fields:{alpha:1},duration:250,silent:!0}).then((()=>{ft.clear()}))}))}()}))}this.ingredients=[],this.ingCount=0,this.finalVariant=[],this.variantCount=0,this.coreOrbs=[],this.remainingTime=120,this.minX=75,this.maxX=645,this.dropping=!1,this.c=p.copy("Cursor",360,300),this.c.scale.x=this.c.scale.y=.25,this.previousOrb=null,this.currentOrb=p.copy(vt(),this.c.x,this.c.y),this.win=!1,this.runningSequence=!1,matter.on("collisionStart",(t=>{if(!this.win)for(var i of t.pairs){if("Protein"===i.bodyA.copy.template&&"Sucrose"===i.bodyB.copy.template||"Sucrose"===i.bodyA.copy.template&&"Protein"===i.bodyB.copy.template){var o=(i.bodyA.copy.position.x+i.bodyB.copy.position.x)/2,n=(i.bodyB.copy.position.y+i.bodyB.copy.position.y)/2;this.ingredients.slice(this.ingredients.indexOf(i.bodyA),1),this.ingredients.slice(this.ingredients.indexOf(i.bodyB),1),i.bodyA.copy.kill=!0,i.bodyB.copy.kill=!0;var s=p.copy("Core",o,n);this.orb=p.copy("Protection",0,0),s.current="Protection",s.protection=s,s.addChild(this.orb),this.coreOrbs.push("Protection"),this.finalVariant.push(s)}if("HMO"===i.bodyA.copy.template&&"HMO"===i.bodyB.copy.template){o=(i.bodyA.copy.position.x+i.bodyB.copy.position.x)/2,n=(i.bodyB.copy.position.y+i.bodyB.copy.position.y)/2;this.ingredients.slice(this.ingredients.indexOf(i.bodyA),1),this.ingredients.slice(this.ingredients.indexOf(i.bodyB),1),i.bodyA.copy.kill=!0,i.bodyB.copy.kill=!0;s=p.copy("Core",o,n);this.orb=p.copy("Brain",0,0),s.current="Brain",s.brain=s,s.addChild(this.orb),this.coreOrbs.push("Brain"),this.finalVariant.push(s)}if("Protein"===i.bodyA.copy.template&&"HMO"===i.bodyB.copy.template||"HMO"===i.bodyA.copy.template&&"Protein"===i.bodyB.copy.template){o=(i.bodyA.copy.position.x+i.bodyB.copy.position.x)/2,n=(i.bodyB.copy.position.y+i.bodyB.copy.position.y)/2;this.ingredients.slice(this.ingredients.indexOf(i.bodyA),1),this.ingredients.slice(this.ingredients.indexOf(i.bodyB),1),i.bodyA.copy.kill=!0,i.bodyB.copy.kill=!0;s=p.copy("Core",o,n);this.orb=p.copy("Growth",0,0),s.current="Growth",s.growth=!0,s.addChild(this.orb),this.coreOrbs.push("Growth"),this.finalVariant.push(s)}if("BLactis"===i.bodyA.copy.template&&"HMO"===i.bodyB.copy.template||"HMO"===i.bodyA.copy.template&&"BLactis"===i.bodyB.copy.template){o=(i.bodyA.copy.position.x+i.bodyB.copy.position.x)/2,n=(i.bodyB.copy.position.y+i.bodyB.copy.position.y)/2;this.ingredients.slice(this.ingredients.indexOf(i.bodyA),1),this.ingredients.slice(this.ingredients.indexOf(i.bodyB),1),i.bodyA.copy.kill=!0,i.bodyB.copy.kill=!0;var r=Math.random()<=.5?"Immunity":"Digestion";s=p.copy("Core",o,n);this.orb=p.copy(r,0,0),"Immunity"==r?s.immunity=s:s.digestion=s,s.current=r,s.addChild(this.orb),s.alpha=1,this.coreOrbs.push(r),this.finalVariant.push(s)}"Core"===i.bodyA.copy.template&&"Core"===i.bodyB.copy.template&&(bt(i.bodyA.copy,i.bodyB.copy.current,i.bodyB.copy),bt(i.bodyB.copy,i.bodyA.copy.current,i.bodyA.copy)),this.coreOrbs.includes("Brain")&&this.coreOrbs.includes("Digestion")&&this.coreOrbs.includes("Growth")&&this.coreOrbs.includes("Immunity")&&this.coreOrbs.includes("Protection")&&(this.win=!0,this.timer1=0,this.runningSequence||(this.runningSequence=!0,e()))}})),matter.on("collisionEnd",(e=>{if(!this.win)for(var t of e.pairs)"Core"===t.bodyA.copy.template&&"Core"===t.bodyB.copy.template&&(bt(t.bodyA.copy,t.bodyB.copy.current,null),bt(t.bodyB.copy,t.bodyA.copy.current,null))})),this.timerLabel=new PIXI.Text("02:00",d.get("RG-Bold")),this.addChild(this.timerLabel),this.timerLabel.x=360,this.timerLabel.y=160,this.timerLabel.anchor.x=.5,this.timer1=1}},isUi:!1,follow:!1,extends:{},bindings:{}},l.templates.Detailer={name:"Detailer",width:720,height:1280,behaviors:JSON.parse("[]"),objects:JSON.parse('[{"x":360,"y":640,"opacity":1,"tint":16777215,"scale":{"x":0.2285,"y":0.2285},"rotation":0,"exts":{},"customProperties":{},"template":"CutBG"},{"x":363,"y":708,"opacity":1,"tint":16777215,"scale":{"x":0.22855,"y":0.22855},"rotation":0,"exts":{},"customProperties":{},"template":"Lightbox"},{"x":360,"y":96,"opacity":1,"tint":16777215,"scale":{"x":0.2,"y":0.2},"rotation":0,"exts":{},"customProperties":{},"template":"Logo"},{"x":683.5625,"y":0,"opacity":0,"tint":16777215,"scale":{"x":1.31933594,"y":19},"rotation":0,"exts":{},"customProperties":{},"template":"Black"},{"x":-10.1875,"y":-97.5,"opacity":0,"tint":16777215,"scale":{"x":11.35253906,"y":4.8828125},"rotation":0,"exts":{},"customProperties":{},"template":"Black"},{"x":-64,"y":0,"opacity":0,"tint":16777215,"scale":{"x":1.67089844,"y":19},"rotation":0,"exts":{},"customProperties":{},"template":"Black"},{"x":-64,"y":1204.0625,"opacity":0,"tint":16777215,"scale":{"x":13,"y":3.18652344},"rotation":0,"exts":{},"customProperties":{},"template":"Black"}]'),bgs:JSON.parse("[]"),tiles:JSON.parse("[]"),backgroundColor:"#212121",onStep(){},onDraw(){},onLeave(){},onCreate(){ft.clear(),this.pressed=!1,this.minY=-130,this.maxY=640,this.scrollParent=p.copy("ScrollParent",360,640),this.addChild(this.scrollParent),this.logo=p.copy("Logo",0,-350),this.scrollParent.addChild(this.logo),this.logo.scale.x=this.logo.scale.y=.2,this.nankid=p.copy("NANKIDLogo",0,-200),this.scrollParent.addChild(this.nankid),this.nankid.scale.x=this.nankid.scale.y=.225,this.head=new PIXI.Text("CONGRATULATIONS!",d.get("RG-Bold_BigBlue")),this.scrollParent.addChild(this.head),this.head.anchor.x=this.head.anchor.y=.5,this.head.scale.x=this.head.scale.y=.6,this.head.y=-50,this.divider=p.copy("Div",0,-15),this.scrollParent.addChild(this.divider),this.divider.anchor.x=this.divider.anchor.y=.5,this.divider.scale.x=this.divider.scale.y=.25,this.description=new PIXI.Text("We believe that a well-brought up child can grow up\nto be the best person they can be with the right support\nand nutrition from the start.\n\nWith each orb, you have combined the nutrients that help\ndoctors and parents nourish all key areas of a child's\ndevelopment, opening them up to infinite possibilities\nfor the future!\n\nFor more than 155 years, Nestlé has been relentlessly\npioneering scientific research in early childhood nutrition.\nSo, with our most scientifically advanced formula with the\nexclusive nutrients of NANKID OPTIPRO, B.Lactis Probiotic,\nOptimized Protein, and clinically provem 5 HMO Complex.\n we continue to pursue the nex scientific breakthroughs\nto give children the 5 Pro Edge!",d.get("Geist-Regular_Blue")),this.scrollParent.addChild(this.description),this.description.anchor.x=.5,this.description.anchor.y=0,this.description.scale.x=this.description.scale.y=.525,this.description.y=0,this.d1=p.copy("Detailer1",5,650),this.scrollParent.addChild(this.d1),this.d1.anchor.x=this.d1.anchor.y=.5,this.d1.scale.x=this.d1.scale.y=.22,this.d2=p.copy("Detailer2",0,1080),this.scrollParent.addChild(this.d2),this.d2.anchor.x=this.d2.anchor.y=.5,this.d2.scale.x=this.d2.scale.y=.225},isUi:!1,follow:!1,extends:{},bindings:{}},l.templates["Try Again"]={name:"Try Again",width:720,height:1280,behaviors:JSON.parse("[]"),objects:JSON.parse('[{"x":-96.8125,"y":-64,"opacity":0.9,"scale":{"x":14,"y":23},"rotation":0,"exts":{},"customProperties":{"newProperty1":"","newProperty2":""},"template":"Placeholder"}]'),bgs:JSON.parse("[]"),tiles:JSON.parse("[]"),backgroundColor:"#212121",onStep(){},onDraw(){ft.down[0]&&!this.pressed&&(this.pressed=!0,wt=0,xt=null,tween.add({obj:this,fields:{alpha:0},duration:250,silent:!0}).then((()=>{l.switch("Game")})))},onLeave(){},onCreate(){ft.clear(),this.timerLabel=new PIXI.Text("TRY AGAIN",d.get("RG-Bold_BigGreen")),this.addChild(this.timerLabel),this.timerLabel.x=150,this.timerLabel.y=400,this.timerLabel.depth=100},isUi:!1,follow:!1,extends:{},bindings:{}},l.templates.Mechanics={name:"Mechanics",width:720,height:1280,behaviors:JSON.parse("[]"),objects:JSON.parse('[{"x":360,"y":640,"opacity":1,"tint":16777215,"scale":{"x":0.22855,"y":0.22855},"rotation":0,"exts":{},"customProperties":{},"template":"Mechanics1"}]'),bgs:JSON.parse("[]"),tiles:JSON.parse("[]"),backgroundColor:"#212121",onStep(){},onDraw(){ft.down[0]&&!this.pressed&&(this.pressed=!0,wt=0,xt=null,tween.add({obj:this,fields:{alpha:0},duration:250,silent:!0}).then((()=>{l.switch("Game")})))},onLeave(){},onCreate(){},isUi:!1,follow:!1,extends:{},bindings:{}}}const yt=function(){var e=function(e){switch(e.shape.type){case"rect":return function(e){const{shape:t}=e,i=new SSCD.Vector(e.x,e.y),o=e instanceof PIXI.NineSlicePlane?1:e.scale.x,n=e instanceof PIXI.NineSlicePlane?1:e.scale.y;if(0===e.angle)return i.x-=o>0?t.left*o:-o*t.right,i.y-=n>0?t.top*n:-t.bottom*n,new SSCD.Rectangle(i,new SSCD.Vector(Math.abs((t.left+t.right)*o),Math.abs((t.bottom+t.top)*n)));const s=u.rotate(-t.left*o,-t.top*n,e.angle),r=u.rotate(-t.left*o,t.bottom*n,e.angle),a=u.rotate(t.right*o,t.bottom*n,e.angle),l=u.rotate(t.right*o,-t.top*n,e.angle);return new SSCD.LineStrip(i,[new SSCD.Vector(s.x,s.y),new SSCD.Vector(r.x,r.y),new SSCD.Vector(a.x,a.y),new SSCD.Vector(l.x,l.y)],!0)}(e);case"circle":return function(e){const{shape:t}=e,i=new SSCD.Vector(e.x,e.y);if(Math.abs(e.scale.x)===Math.abs(e.scale.y))return new SSCD.Circle(i,t.r*Math.abs(e.scale.x));const o=[];for(let i=0;i<16;i++){const n=[u.ldx(t.r*e.scale.x,22.5*i),u.ldy(t.r*e.scale.y,22.5*i)];if(0!==e.angle){const{x:t,y:i}=u.rotate(n[0],n[1],e.angle);o.push(new SSCD.Vector(t,i))}else o.push(new SSCD.Vector(n[0],n[1]))}return new SSCD.LineStrip(i,o,!0)}(e);case"strip":return function(e){const{shape:t}=e,i=new SSCD.Vector(e.x,e.y),o=e instanceof PIXI.NineSlicePlane?1:e.scale.x,n=e instanceof PIXI.NineSlicePlane?1:e.scale.y,s=[];if(0!==e.angle)for(const i of t.points){const{x:t,y:r}=u.rotate(i.x*o,i.y*n,e.angle);s.push(new SSCD.Vector(t,r))}else for(const e of t.points)s.push(new SSCD.Vector(e.x*o,e.y*n));return new SSCD.LineStrip(i,s,Boolean(t.closedStrip))}(e);case"line":return function(e){const{shape:t}=e;if(0!==e.angle){const{x:i,y:o}=u.rotate(t.x1*e.scale.x,t.y1*e.scale.y,e.angle),{x:n,y:s}=u.rotate(t.x2*e.scale.x,t.y2*e.scale.y,e.angle);return new SSCD.Line(new SSCD.Vector(e.x+i,e.y+o),new SSCD.Vector(n-i,s-o))}return new SSCD.Line(new SSCD.Vector(e.x+t.x1*e.scale.x,e.y+t.y1*e.scale.y),new SSCD.Vector((t.x2-t.x1)*e.scale.x,(t.y2-t.y1)*e.scale.y))}(e);default:return new SSCD.Circle(new SSCD.Vector(e.x,e.y),0)}};const t=(e,t,i)=>t.template===i,i=(e,t,i)=>!i||i===t.cgroup,o=function(t,i,o,s,r,a,l){const h=t.x,c=t.y,d=t._shape;let p,u;void 0===i||h===i&&c===o?(p=t.$chashes||n.getHashes(t),t._shape=t._shape||e(t)):(t.x=i,t.y=o,t._shape=e(t),p=n.getHashes(t)),r&&(u=[]);for(const e of p){const i=s[e];if(i)for(const e of i)if(e!==t&&a(t,e,l)&&n.collide(t,e)){if(!r)return h===t.x&&c===t.y||(t.x=h,t.y=c,t._shape=d),e;u.includes(e)||u.push(e)}}return h===t.x&&c===t.y||(t.x=h,t.y=c,t._shape=d),!!r&&u},n={m:1,gridX:1024,gridY:1024,grid:{},tileGrid:{},getHashes(e){var t=[],i=Math.round(e.x/n.gridX),o=Math.round(e.y/n.gridY),s=Math.sign(e.x-n.gridX*i),r=Math.sign(e.y-n.gridY*o);return t.push(`${i}:${o}`),s&&(t.push(`${i+s}:${o}`),r&&t.push(`${i+s}:${o+r}`)),r&&t.push(`${i}:${o+r}`),t},drawDebugGraphic(t){const i=this._shape||e(this),o=this.$cDebugCollision,n=this.transform.localTransform.clone().invert();this.$cDebugCollision.transform.setFromMatrix(n),this.$cDebugCollision.position.set(0,0);let s=65535;if(this instanceof Be?s=26367:this instanceof PIXI.Sprite&&(s=6684927),this.$cHadCollision&&(s=65280),o.lineStyle(2,s),i instanceof SSCD.Rectangle){const e=i.get_position(),n=i.get_size();o.beginFill(s,.1),t?o.drawRect(e.x,e.y,n.x,n.y):o.drawRect(e.x-this.x,e.y-this.y,n.x,n.y),o.endFill()}else if(i instanceof SSCD.LineStrip)if(t){o.moveTo(i.__points[0].x+this.x,i.__points[0].y+this.y);for(let e=1;e<i.__points.length;e++)o.lineTo(i.__points[e].x+this.x,i.__points[e].y+this.y)}else{o.moveTo(i.__points[0].x,i.__points[0].y);for(let e=1;e<i.__points.length;e++)o.lineTo(i.__points[e].x,i.__points[e].y)}else if(i instanceof SSCD.Circle&&i.get_radius()>0)o.beginFill(s,.1),t?o.drawCircle(this.x,this.y,i.get_radius()):o.drawCircle(0,0,i.get_radius()),o.endFill();else if(i instanceof SSCD.Line)if(t){const e=i.get_p1(),t=i.get_p2();o.moveTo(e.x,e.y).lineTo(t.x,t.y)}else o.moveTo(i.__position.x,i.__position.y).lineTo(i.__position.x+i.__dest.x,i.__position.y+i.__dest.y);else t?o.moveTo(-16+this.x,-16+this.y).lineTo(16+this.x,16+this.y).moveTo(-16+this.x,16+this.y).lineTo(16+this.x,-16+this.y):o.moveTo(-16,-16).lineTo(16,16).moveTo(-16,16).lineTo(16,-16)},collide(t,i){if(t._shape=t._shape||e(t),i._shape=i._shape||e(i),"strip"===t._shape.__type||"strip"===i._shape.__type||"complex"===t._shape.__type||"complex"===i._shape.__type){const e=t._shape.get_aabb(),o=i._shape.get_aabb();if(!e.intersects(o))return!1}return!!SSCD.CollisionManager.test_collision(t._shape,i._shape)},occupied(e,t,s,r){"number"!=typeof s&&(r=t,t=void 0,s=void 0);const a=o(e,t,s,n.grid,!1,i,r);return a||o(e,t,s,n.tileGrid,!1,i,r)},occupiedMultiple(e,t,s,r){"number"!=typeof s&&(r=t,t=void 0,s=void 0);const a=o(e,t,s,n.grid,!0,i,r),l=o(e,t,s,n.tileGrid,!0,i,r);return a.concat(l)},free:(e,t,i,o)=>!n.occupied(e,t,i,o),meet:(e,i,s,r)=>("number"!=typeof s&&(r=i,i=void 0,s=void 0),o(e,i,s,n.grid,!1,t,r)),meetMultiple:(e,i,s,r)=>("number"!=typeof s&&(r=i,i=void 0,s=void 0),o(e,i,s,n.grid,!0,t,r)),copies:(e,t,s,r)=>("number"!=typeof s&&(r=t,t=void 0,s=void 0),o(e,t,s,n.grid,!1,i,r)),copiesMultiple:(e,t,s,r)=>("number"!=typeof s&&(r=t,t=void 0,s=void 0),o(e,t,s,n.grid,!0,i,r)),tiles:(e,t,s,r)=>("number"!=typeof s&&(r=t,t=void 0,s=void 0),o(e,t,s,n.tileGrid,!1,i,r)),tilesMultiple:(e,t,s,r)=>("number"!=typeof s&&(r=t,t=void 0,s=void 0),o(e,t,s,n.tileGrid,!0,i,r)),lastdist:null,nearest(e,t,i){const o=templates.list[i];if(o.length>0){var s=Math.hypot(e-o[0].x,t-o[0].y),r=o[0];for(const i of o)Math.hypot(e-i.x,t-i.y)<s&&(s=Math.hypot(e-i.x,t-i.y),r=i);return n.lastdist=s,r}return!1},furthest(e,t,i){const o=o.list[i];if(o.length>0){var s=Math.hypot(e-o[0].x,t-o[0].y),r=o[0];for(const i of o)Math.hypot(e-i.x,t-i.y)>s&&(s=Math.hypot(e-i.x,t-i.y),r=i);return n.lastdist=s,r}return!1},enableTilemapCollisions(t,i){const o=i||t.cgroup;if(t.addedCollisions)throw new Error("[place] The tilemap already has collisions enabled.");t.cgroup=o;for(const i of t.pixiTiles){i._shape=e(i),i.cgroup=o,i.$chashes=n.getHashes(i);for(const e of i.$chashes)e in n.tileGrid?n.tileGrid[e].push(i):n.tileGrid[e]=[i];i.depth=t.depth}t.addedCollisions=!0},moveAlong(e,t,i,o,s){if(!i)return!1;"number"==typeof o&&(s=o,o=void 0),s=Math.abs(s||1),i<0&&(i*=-1,t+=180);for(var r=Math.cos(t*Math.PI/180)*s,a=Math.sin(t*Math.PI/180)*s;i>0;){i<1&&(r*=i,a*=i);const t=n.occupied(e,e.x+r,e.y+a,o);if(t)return t;e.x+=r,e.y+=a,delete e._shape,i--}return!1},moveByAxes(e,t,i,o,s){if(t===i===0)return!1;"number"==typeof o&&(s=o,o=void 0);const r={x:!1,y:!1};for(s=Math.abs(s||1);Math.abs(t)>s;){const i=n.occupied(e,e.x+Math.sign(t)*s,e.y,o);if(i){r.x=i;break}e.x+=Math.sign(t)*s,t-=Math.sign(t)*s}for(;Math.abs(i)>s;){const t=n.occupied(e,e.x,e.y+Math.sign(i)*s,o);if(t){r.y=t;break}e.y+=Math.sign(i)*s,i-=Math.sign(i)*s}return Math.abs(t)<s&&n.free(e,e.x+t,e.y,o)&&(e.x+=t),Math.abs(i)<s&&n.free(e,e.x,e.y+i,o)&&(e.y+=i),!(!r.x&&!r.y)&&r},go(e,t,i,o,s){if(u.pdc(e.x,e.y,t,i)<o)return void(n.free(e,t,i,s)&&(e.x=t,e.y=i,delete e._shape));var r=u.pdn(e.x,e.y,t,i);let a=e.x+u.ldx(o,r),l=e.y+u.ldy(o,r);if(n.free(e,a,l,s))e.x=a,e.y=l,delete e._shape,e.dir=r;else for(var h=-1;h<=1;h+=2)for(var c=30;c<150;c+=30)if(a=e.x+u.ldx(o,r+c*n.m*h),l=e.y+u.ldy(o,r+c*n.m*h),n.free(e,a,l,s))return e.x=a,e.y=l,delete e._shape,void(e.dir=r+c*n.m*h)},traceCustom(e,t,i,o){const s=[];if(!t)return o?n.occupiedMultiple(e,i):n.occupied(e,i);for(const t of mt)if((!i||t.cgroup===i)&&n.collide(e,t)){if(!o)return t;s.push(t)}for(const t of templates.list.TILEMAP)if(t.addedCollisions&&(!i||t.cgroup===i))for(const i of t.pixiTiles)if(n.collide(e,i)){if(!o)return i;s.push(i)}return!!o&&s},traceLine(e,t,i){let o=!1;(Math.abs(e.x1-e.x2)>n.gridX||Math.abs(e.y1-e.y2)>n.gridY)&&(o=!0);const s={x:e.x1,y:e.y1,scale:{x:1,y:1},rotation:0,angle:0,shape:{type:"line",x1:0,y1:0,x2:e.x2-e.x1,y2:e.y2-e.y1}},r=n.traceCustom(s,o,t,i);return i&&r.sort((function(t,i){return u.pdc(e.x1,e.y1,t.x,t.y)-u.pdc(e.x1,e.y1,i.x,i.y)})),r},traceRect(e,t,i){let o=!1;"x1"in(e={...e})&&(e.x=e.x1,e.y=e.y1,e.width=e.x2-e.x1,e.height=e.y2-e.y1),(Math.abs(e.width)>n.gridX||Math.abs(e.height)>n.gridY)&&(o=!0);const s={x:e.x,y:e.y,scale:{x:1,y:1},rotation:0,angle:0,shape:{type:"rect",left:0,top:0,right:e.width,bottom:e.height}};return n.traceCustom(s,o,t,i)},traceCircle(e,t,i){let o=!1;(2*e.radius>n.gridX||2*e.radius>n.gridY)&&(o=!0);const s={x:e.x,y:e.y,scale:{x:1,y:1},rotation:0,angle:0,shape:{type:"circle",r:e.radius}};return n.traceCustom(s,o,t,i)},tracePolyline(e,t,i){const o={x:0,y:0,scale:{x:1,y:1},rotation:0,angle:0,shape:{type:"strip",points:e}};return n.traceCustom(o,!0,t,i)},tracePoint(e,t,i){const o={x:e.x,y:e.y,scale:{x:1,y:1},rotation:0,angle:0,shape:{type:"point"}};return n.traceCustom(o,!1,t,i)}};return n.traceRectange=n.traceRect,setInterval((function(){n.m*=-1}),789),Object.defineProperty(templates.CopyProto,"moveContinuous",{value:function(e,t){return this.gravity&&(this.hspeed+=this.gravity*u.time*Math.cos(this.gravityDir*Math.PI/180),this.vspeed+=this.gravity*u.time*Math.sin(this.gravityDir*Math.PI/180)),n.moveAlong(this,this.direction,this.speed*u.time,e,t)}}),Object.defineProperty(templates.CopyProto,"moveBullet",{value:function(e,t){return this.moveContinuous(e,t)}}),Object.defineProperty(templates.CopyProto,"moveContinuousByAxes",{value:function(e,t){return this.gravity&&(this.hspeed+=this.gravity*u.time*Math.cos(this.gravityDir*Math.PI/180),this.vspeed+=this.gravity*u.time*Math.sin(this.gravityDir*Math.PI/180)),n.moveByAxes(this,this.hspeed*u.time,this.vspeed*u.time,e,t)}}),Object.defineProperty(templates.CopyProto,"moveSmart",{value:function(e,t){return this.moveContinuousByAxes(e,t)}}),Object.defineProperty(templates.Tilemap.prototype,"enableCollisions",{value:function(e){n.enableTilemapCollisions(this,e)}}),window.place=n,n}(),ft=function(){const e="pointer.",t=function(t,i){inputs.registry[e+t]=i},i={Primary:1,Middle:4,Secondary:2,ExtraOne:8,ExtraTwo:16,Eraser:32};var o=0,n=0,s=0,r=0,a=0,l=()=>{t("Any",C.down.length>0?1:0),t("Double",C.down.length>1?1:0),t("Triple",C.down.length>2?1:0)},h=e=>{const t=lt.view.getBoundingClientRect(),i=(e.clientX-t.left)/t.width*camera.width,o=(e.clientY-t.top)/t.height*camera.height,n=camera.uiToGameCoord(i,o);return{id:e.pointerId,x:n.x,y:n.y,clientX:e.clientX,clientY:e.clientY,xui:i,yui:o,xprev:n.x,yprev:n.y,buttons:e.buttons,xuiprev:i,yuiprev:o,pressure:e.pressure,tiltX:e.tiltX,tiltY:e.tiltY,twist:e.twist,type:e.pointerType,width:e.width/t.width*camera.width,height:e.height/t.height*camera.height}},c=(e,t)=>{const i=lt.view.getBoundingClientRect(),o=(t.clientX-i.left)/i.width*camera.width,n=(t.clientY-i.top)/i.height*camera.height,s=camera.uiToGameCoord(o,n);Object.assign(e,{x:s.x,y:s.y,xui:o,yui:n,clientX:t.clientX,clientY:t.clientY,pressure:t.pressure,buttons:t.buttons,tiltX:t.tiltX,tiltY:t.tiltY,twist:t.twist,width:t.width/i.width*camera.width,height:t.height/i.height*camera.height})},d=function(e){Object.assign(C,{x:e.x,y:e.y,xui:e.xui,yui:e.yui,pressure:e.pressure,buttons:e.buttons,tiltX:e.tiltX,tiltY:e.tiltY,twist:e.twist})},p=function(e){window.focus();const t=h(e);C.hover.push(t),e.isPrimary&&d(t)},m=function(e){const t=C.hover.find((t=>t.id===e.pointerId));t&&(t.invalid=!0,C.hover.splice(C.hover.indexOf(t),1));const i=C.down.findIndex((t=>t.id===e.pointerId));-1!==i&&C.down.splice(i,1)},y=function(e){ut.preventDefault&&e.preventDefault();let t=C.hover.find((t=>t.id===e.pointerId));t||(p(e),t=C.hover.find((t=>t.id===e.pointerId)));const i=C.down.find((t=>t.id===e.pointerId));(t||i)&&(t&&c(t,e),i&&c(i,e),e.isPrimary&&d(t||i))},f=function(e){ut.preventDefault&&e.preventDefault(),C.type=e.pointerType;const t=h(e);C.down.push(t),l(),e.isPrimary&&d(t)},g=function(e){ut.preventDefault&&e.preventDefault();const t=C.down.find((t=>t.id===e.pointerId));t&&C.released.push(t),-1!==C.down.indexOf(t)&&C.down.splice(C.down.indexOf(t),1),l()},x=function(e){t("Wheel",(e.wheelDelta||-e.detail)<0?-1:1),ut.preventDefault&&e.preventDefault()};let w=!1;const b=function(e,t,i,o){if(w)return!1;for(const n of i)if((!t||n.id===t.id)&&yt.collide(e,{x:o?n.xui:n.x,y:o?n.yui:n.y,scale:{x:1,y:1},angle:0,shape:{type:"rect",top:n.height/2,bottom:n.height/2,left:n.width/2,right:n.width/2}}))return n;return!1},v=function(){if(!document.pointerLockElement&&!document.mozPointerLockElement){(document.body.requestPointerLock||document.body.mozRequestPointerLock).apply(document.body)}},S=function(e){const t=lt.view.getBoundingClientRect(),i=e.movementX/t.width*camera.width,o=e.movementY/t.height*camera.height;C.xlocked+=i,C.ylocked+=o,C.xmovement=i,C.ymovement=o},C={setupListeners(){document.addEventListener("pointerenter",p,{capture:!0}),document.addEventListener("pointerout",m,{capture:!0}),document.addEventListener("pointerleave",m,{capture:!0}),document.addEventListener("pointerdown",f,{capture:!0}),document.addEventListener("pointerup",g,{capture:!0}),document.addEventListener("pointercancel",g,{capture:!0}),document.addEventListener("pointermove",y,{capture:!0}),document.addEventListener("wheel",x,{passive:!1}),document.addEventListener("DOMMouseScroll",x,{passive:!1}),document.addEventListener("contextmenu",(e=>{ut.preventDefault&&e.preventDefault()}))},hover:[],down:[],released:[],x:0,y:0,xprev:0,yprev:0,xui:0,yui:0,xuiprev:0,yuiprev:0,xlocked:0,ylocked:0,xmovement:0,ymovement:0,pressure:1,buttons:0,tiltX:0,tiltY:0,twist:0,width:1,height:1,type:null,clear(){C.down.length=0,C.hover.length=0,C.clearReleased(),l()},clearReleased(){C.released.length=0},collides(e,t,i){var o=i?C.released:C.down;return b(e,t,o,!1)},collidesUi(e,t,i){var o=i?C.released:C.down;return b(e,t,o,!0)},hovers:(e,t)=>b(e,t,C.hover,!1),hoversUi:(e,t)=>b(e,t,C.hover,!0),isButtonPressed(t,o){return o?(o.buttons&i[t])===t?1:0:Boolean((n=t,inputs.registry[e+n]));var n},updateGestures(){let e=0,l=0;const h=lt.view.getBoundingClientRect();for(const t of C.down)e+=(t.clientX-h.left)/h.width,l+=(t.clientY-h.top)/h.height;e/=C.down.length,l/=C.down.length;let c=0,d=r;if(C.down.length>1){const e=[C.down[0],C.down[1]].sort(((e,t)=>e.id-t.id));c=u.pdn(e[0].x,e[0].y,e[1].x,e[1].y),d=u.pdc(e[0].x,e[0].y,e[1].x,e[1].y)}o===C.down.length?(C.down.length>1?(t("DeltaRotation",u.degToRad(u.deltaDir(a,c))),t("DeltaPinch",d/r-1)):(t("DeltaPinch",0),t("DeltaRotation",0)),C.down.length?(t("PanX",e-n),t("PanY",l-s)):(t("PanX",0),t("PanY",0))):(o=C.down.length,t("DeltaPinch",0),t("DeltaRotation",0),t("PanX",0),t("PanY",0)),n=e,s=l,a=c,r=d;for(const e in i){t(e,0);for(const o of C.down)(o.buttons&i[e])===i[e]&&t(e,1)}},lock(){if(w)return;w=!0,C.xlocked=C.xui,C.ylocked=C.yui;(document.body.requestPointerLock||document.body.mozRequestPointerLock).apply(document.body),document.addEventListener("click",v,{capture:!0}),document.addEventListener("pointermove",S,{capture:!0})},unlock(){w&&(w=!1,(document.pointerLockElement||document.mozPointerLockElement)&&(document.exitPointerLock||document.mozExitPointerLock)(),document.removeEventListener("click",v),document.removeEventListener("pointermove",S))},get locked(){return Boolean(document.pointerLockElement||document.mozPointerLockElement)}};return t("Wheel",0),window.pointer=C,C}(),gt=function(){var e=function(e,t){inputs.registry["keyboard."+e]=t};const t={string:"",lastKey:"",lastCode:"",alt:!1,shift:!1,ctrl:!1,clear(){delete t.lastKey,delete t.lastCode,t.string="",t.alt=!1,t.shift=!1,t.ctrl=!1},check:[],onDown(i){t.shift=i.shiftKey,t.alt=i.altKey,t.ctrl=i.ctrlKey,t.lastKey=i.key,t.lastCode=i.code,i.code?e(i.code,1):e("Unknown",1),i.key&&(1===i.key.length?t.string+=i.key:"Backspace"===i.key?t.string=t.string.slice(0,-1):"Enter"===i.key&&(t.string="")),ut.preventDefault&&i.preventDefault()},onUp(i){t.shift=i.shiftKey,t.alt=i.altKey,t.ctrl=i.ctrlKey,i.code?e(i.code,0):e("Unknown",0),ut.preventDefault&&i.preventDefault()}};return document.addEventListener?(document.addEventListener("keydown",t.onDown,!1),document.addEventListener("keyup",t.onUp,!1)):(document.attachEvent("onkeydown",t.onDown),document.attachEvent("onkeyup",t.onUp)),window.keyboard=t,t}();!function(e){"use strict";var t="KeyboardEvent"in e;t||(e.KeyboardEvent=function(){throw TypeError("Illegal constructor")}),[["DOM_KEY_LOCATION_STANDARD",0],["DOM_KEY_LOCATION_LEFT",1],["DOM_KEY_LOCATION_RIGHT",2],["DOM_KEY_LOCATION_NUMPAD",3]].forEach((function(t){t[0]in e.KeyboardEvent||(e.KeyboardEvent[t[0]]=t[1])}));var i=e.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,o=e.KeyboardEvent.DOM_KEY_LOCATION_LEFT,n=e.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,s=e.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD;function r(e,t){return-1!==String(e).indexOf(t)}var a=r(navigator.platform,"Win")?"win":r(navigator.platform,"Mac")?"mac":r(navigator.platform,"CrOS")?"cros":r(navigator.platform,"Linux")?"linux":r(navigator.userAgent,"iPad")||r(navigator.platform,"iPod")||r(navigator.platform,"iPhone")?"ios":"",l=r(navigator.userAgent,"Chrome/")?"chrome":r(navigator.vendor,"Apple")?"safari":r(navigator.userAgent,"MSIE")?"ie":r(navigator.userAgent,"Gecko/")?"moz":r(navigator.userAgent,"Opera/")?"opera":"",h=l+"-"+a;function c(e,t,i){h!==t&&l!==t&&a!==t||Object.keys(i).forEach((function(t){e[t]=i[t]}))}var d={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"Lang1"},25:{code:"Lang2"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"MetaLeft",location:o},92:{code:"MetaRight",location:n},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0",location:s},97:{code:"Numpad1",keyCap:"1",location:s},98:{code:"Numpad2",keyCap:"2",location:s},99:{code:"Numpad3",keyCap:"3",location:s},100:{code:"Numpad4",keyCap:"4",location:s},101:{code:"Numpad5",keyCap:"5",location:s},102:{code:"Numpad6",keyCap:"6",location:s},103:{code:"Numpad7",keyCap:"7",location:s},104:{code:"Numpad8",keyCap:"8",location:s},105:{code:"Numpad9",keyCap:"9",location:s},106:{code:"NumpadMultiply",keyCap:"*",location:s},107:{code:"NumpadAdd",keyCap:"+",location:s},108:{code:"NumpadComma",keyCap:",",location:s},109:{code:"NumpadSubtract",keyCap:"-",location:s},110:{code:"NumpadDecimal",keyCap:".",location:s},111:{code:"NumpadDivide",keyCap:"/",location:s},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock",location:s},145:{code:"ScrollLock"},160:{code:"ShiftLeft",location:o},161:{code:"ShiftRight",location:n},162:{code:"ControlLeft",location:o},163:{code:"ControlRight",location:n},164:{code:"AltLeft",location:o},165:{code:"AltRight",location:n},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"AudioVolumeMute"},174:{code:"AudioVolumeDown"},175:{code:"AudioVolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}};c(d,"moz",{59:{code:"Semicolon",keyCap:";"},61:{code:"Equal",keyCap:"="},107:{code:"Equal",keyCap:"="},109:{code:"Minus",keyCap:"-"},187:{code:"NumpadAdd",keyCap:"+",location:s},189:{code:"NumpadSubtract",keyCap:"-",location:s}}),c(d,"moz-mac",{12:{code:"NumLock",location:s},173:{code:"Minus",keyCap:"-"}}),c(d,"moz-win",{173:{code:"Minus",keyCap:"-"}}),c(d,"chrome-mac",{93:{code:"MetaRight",location:n}}),c(d,"safari",{3:{code:"Enter"},25:{code:"Tab"}}),c(d,"ios",{10:{code:"Enter",location:i}}),c(d,"safari-mac",{91:{code:"MetaLeft",location:o},93:{code:"MetaRight",location:n},229:{code:"KeyQ",keyCap:"Q"}});var p={};"cros"===a&&(p["U+00A0"]={code:"ShiftLeft",location:o},p["U+00A1"]={code:"ShiftRight",location:n},p["U+00A2"]={code:"ControlLeft",location:o},p["U+00A3"]={code:"ControlRight",location:n},p["U+00A4"]={code:"AltLeft",location:o},p["U+00A5"]={code:"AltRight",location:n}),"chrome-mac"===h&&(p["U+0010"]={code:"ContextMenu"}),"safari-mac"===h&&(p["U+0010"]={code:"ContextMenu"}),"ios"===a&&(p["U+0010"]={code:"Function"},p["U+001C"]={code:"ArrowLeft"},p["U+001D"]={code:"ArrowRight"},p["U+001E"]={code:"ArrowUp"},p["U+001F"]={code:"ArrowDown"},p["U+0001"]={code:"Home"},p["U+0004"]={code:"End"},p["U+000B"]={code:"PageUp"},p["U+000C"]={code:"PageDown"});var u=[];u[o]={16:{code:"ShiftLeft",location:o},17:{code:"ControlLeft",location:o},18:{code:"AltLeft",location:o}},u[n]={16:{code:"ShiftRight",location:n},17:{code:"ControlRight",location:n},18:{code:"AltRight",location:n}},u[s]={13:{code:"NumpadEnter",location:s}},c(u[s],"moz",{109:{code:"NumpadSubtract",location:s},107:{code:"NumpadAdd",location:s}}),c(u[o],"moz-mac",{224:{code:"MetaLeft",location:o}}),c(u[n],"moz-mac",{224:{code:"MetaRight",location:n}}),c(u[n],"moz-win",{91:{code:"MetaRight",location:n}}),c(u[n],"mac",{93:{code:"MetaRight",location:n}}),c(u[s],"chrome-mac",{12:{code:"NumLock",location:s}}),c(u[s],"safari-mac",{12:{code:"NumLock",location:s},187:{code:"NumpadAdd",location:s},189:{code:"NumpadSubtract",location:s},190:{code:"NumpadDecimal",location:s},191:{code:"NumpadDivide",location:s}});var m={ShiftLeft:{key:"Shift"},ShiftRight:{key:"Shift"},ControlLeft:{key:"Control"},ControlRight:{key:"Control"},AltLeft:{key:"Alt"},AltRight:{key:"Alt"},MetaLeft:{key:"Meta"},MetaRight:{key:"Meta"},NumpadEnter:{key:"Enter"},Space:{key:" "},Digit0:{key:"0",shiftKey:")"},Digit1:{key:"1",shiftKey:"!"},Digit2:{key:"2",shiftKey:"@"},Digit3:{key:"3",shiftKey:"#"},Digit4:{key:"4",shiftKey:"$"},Digit5:{key:"5",shiftKey:"%"},Digit6:{key:"6",shiftKey:"^"},Digit7:{key:"7",shiftKey:"&"},Digit8:{key:"8",shiftKey:"*"},Digit9:{key:"9",shiftKey:"("},KeyA:{key:"a",shiftKey:"A"},KeyB:{key:"b",shiftKey:"B"},KeyC:{key:"c",shiftKey:"C"},KeyD:{key:"d",shiftKey:"D"},KeyE:{key:"e",shiftKey:"E"},KeyF:{key:"f",shiftKey:"F"},KeyG:{key:"g",shiftKey:"G"},KeyH:{key:"h",shiftKey:"H"},KeyI:{key:"i",shiftKey:"I"},KeyJ:{key:"j",shiftKey:"J"},KeyK:{key:"k",shiftKey:"K"},KeyL:{key:"l",shiftKey:"L"},KeyM:{key:"m",shiftKey:"M"},KeyN:{key:"n",shiftKey:"N"},KeyO:{key:"o",shiftKey:"O"},KeyP:{key:"p",shiftKey:"P"},KeyQ:{key:"q",shiftKey:"Q"},KeyR:{key:"r",shiftKey:"R"},KeyS:{key:"s",shiftKey:"S"},KeyT:{key:"t",shiftKey:"T"},KeyU:{key:"u",shiftKey:"U"},KeyV:{key:"v",shiftKey:"V"},KeyW:{key:"w",shiftKey:"W"},KeyX:{key:"x",shiftKey:"X"},KeyY:{key:"y",shiftKey:"Y"},KeyZ:{key:"z",shiftKey:"Z"},Numpad0:{key:"0"},Numpad1:{key:"1"},Numpad2:{key:"2"},Numpad3:{key:"3"},Numpad4:{key:"4"},Numpad5:{key:"5"},Numpad6:{key:"6"},Numpad7:{key:"7"},Numpad8:{key:"8"},Numpad9:{key:"9"},NumpadMultiply:{key:"*"},NumpadAdd:{key:"+"},NumpadComma:{key:","},NumpadSubtract:{key:"-"},NumpadDecimal:{key:"."},NumpadDivide:{key:"/"},Semicolon:{key:";",shiftKey:":"},Equal:{key:"=",shiftKey:"+"},Comma:{key:",",shiftKey:"<"},Minus:{key:"-",shiftKey:"_"},Period:{key:".",shiftKey:">"},Slash:{key:"/",shiftKey:"?"},Backquote:{key:"`",shiftKey:"~"},BracketLeft:{key:"[",shiftKey:"{"},Backslash:{key:"\\",shiftKey:"|"},BracketRight:{key:"]",shiftKey:"}"},Quote:{key:"'",shiftKey:'"'},IntlBackslash:{key:"\\",shiftKey:"|"}};c(m,"mac",{MetaLeft:{key:"Meta"},MetaRight:{key:"Meta"}});var y,f,g,x={Add:"+",Decimal:".",Divide:"/",Subtract:"-",Multiply:"*",Spacebar:" ",Esc:"Escape",Nonconvert:"NonConvert",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Menu:"ContextMenu",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",SelectMedia:"MediaSelect",HalfWidth:"Hankaku",FullWidth:"Zenkaku",RomanCharacters:"Romaji",Crsel:"CrSel",Exsel:"ExSel",Zoom:"ZoomToggle"},w=(y=d,f="code",g={},Object.keys(y).forEach((function(e){var t=y[e];f in t&&(g[t[f]]=t)})),g);try{var b=t&&"location"in new KeyboardEvent("")}catch(e){}function v(e){var t="keyCode"in e?e.keyCode:"which"in e?e.which:0,i=function(){if(b||"keyLocation"in e){var i=b?e.location:e.keyLocation;if(i&&t in u[i])return u[i][t]}return"keyIdentifier"in e&&e.keyIdentifier in p?p[e.keyIdentifier]:t in d?d[t]:null}();if(!i)return null;var o,n=(o=m[i.code])?e.shiftKey&&"shiftKey"in o?o.shiftKey:o.key:i.code;return{code:i.code,key:n,location:i.location,keyCap:i.keyCap}}"KeyboardEvent"in e&&"defineProperty"in Object&&function(){function e(e,t,i){t in e||Object.defineProperty(e,t,i)}if(e(KeyboardEvent.prototype,"code",{get:function(){var e=v(this);return e?e.code:""}}),"key"in KeyboardEvent.prototype){var t=Object.getOwnPropertyDescriptor(KeyboardEvent.prototype,"key");Object.defineProperty(KeyboardEvent.prototype,"key",{get:function(){var e=t.get.call(this);return x.hasOwnProperty(e)?x[e]:e}})}e(KeyboardEvent.prototype,"key",{get:function(){var e=v(this);return e&&"key"in e?e.key:"Unidentified"}}),e(KeyboardEvent.prototype,"location",{get:function(){var e=v(this);return e&&"location"in e?e.location:i}}),e(KeyboardEvent.prototype,"locale",{get:function(){return""}})}(),"queryKeyCap"in e.KeyboardEvent||(e.KeyboardEvent.queryKeyCap=function(e,t){if(e=String(e),!w.hasOwnProperty(e))return"Undefined";if(t&&"en-us"!==String(t).toLowerCase())throw Error("Unsupported locale");var i=w[e];return i.keyCap||i.code||"Undefined"}),e.identifyKey=function(e){if(!("code"in e)){var t=v(e);e.code=t?t.code:"",e.key=t&&"key"in t?t.key:"Unidentified",e.location="location"in e?e.location:"keyLocation"in e?e.keyLocation:t&&"location"in t?t.location:i,e.locale=""}}}(self);{const e={add(t){const i={obj:t.obj,fields:t.fields||{},curve:t.curve||e.ease,duration:t.duration||1e3,timer:new C(t.duration,!1,t.isUi||!1)},o=new Promise(((t,o)=>{i.resolve=t,i.reject=o,i.starting={};for(const e in i.fields)i.starting[e]=i.obj[e]||0;e.tweens.push(i)}));return t.silent&&(o.catch((()=>{})),i.timer.catch((()=>{}))),o.stop=function(){i.reject({code:0,info:"Stopped by game logic",from:"tween"})},o},linear:(e,t,i)=>t*i+e,ease:(e,t,i)=>(i*=2)<1?t/2*i*i+e:-t/2*(--i*(i-2)-1)+e,easeInQuad:(e,t,i)=>t*i*i+e,easeOutQuad:(e,t,i)=>-t*i*(i-2)+e,easeInCubic:(e,t,i)=>t*i*i*i+e,easeOutCubic:(e,t,i)=>t*(--i*i*i+1)+e,easeInOutCubic:(e,t,i)=>(i*=2)<1?t/2*i*i*i+e:t/2*((i-=2)*i*i+2)+e,easeInOutQuart:(e,t,i)=>(i*=2)<1?t/2*i*i*i*i+e:-t/2*((i-=2)*i*i*i-2)+e,easeInQuart:(e,t,i)=>t*i*i*i*i+e,easeOutQuart:(e,t,i)=>-t*(--i*i*i*i-1)+e,easeInCirc:(e,t,i)=>-t*(Math.sqrt(1-i*i)-1)+e,easeOutCirc:(e,t,i)=>(i--,t*Math.sqrt(1-i*i)+e),easeInOutCirc:(e,t,i)=>(i*=2)<1?-t/2*(Math.sqrt(1-i*i)-1)+e:(i-=2,t/2*(Math.sqrt(1-i*i)+1)+e),easeInBack(e,t,i){const o=1.70158;return t*(2.70158*i*i*i-o*i*i)+e},easeOutBack(e,t,i){const o=1.70158;return t*(1+2.70158*(i-1)**3+o*(i-1)**2)+e},easeInOutBack(e,t,i){const o=2.5949095;return t*(i<.5?(2*i)**2*(7.189819*i-o)/2:((2*i-2)**2*((o+1)*(2*i-2)+o)+2)/2)+e},easeInElastic(e,t,i){const o=2*Math.PI/3;return t*(0===i?0:1===i?1:-(2**(10*i-10))*Math.sin((10*i-10.75)*o))+e},easeOutElastic(e,t,i){const o=2*Math.PI/3;return t*(0===i?0:1===i?1:2**(-10*i)*Math.sin((10*i-.75)*o)+1)+e},easeInOutElastic(e,t,i){const o=2*Math.PI/4.5;return t*(0===i?0:1===i?1:i<.5?-(2**(20*i-10))*Math.sin((20*i-11.125)*o)/2:2**(-20*i+10)*Math.sin((20*i-11.125)*o)/2+1)+e},easeOutBounce(e,t,i){const o=7.5625,n=2.75;let s;return s=i<1/n?o*i*i:i<2/n?o*(i-=1.5/n)*i+.75:i<2.5/n?o*(i-=2.25/n)*i+.9375:o*(i-=2.625/n)*i+.984375,t*s+e},easeInBounce(e,t,i){const o=7.5625,n=2.75;let s;return s=(i=1-i)<1/n?o*i*i:i<2/n?o*(i-=1.5/n)*i+.75:i<2.5/n?o*(i-=2.25/n)*i+.9375:o*(i-=2.625/n)*i+.984375,t*(1-s)+e},easeInOutBounce(e,t,i){const o=7.5625,n=2.75;let s,r;return r=i<.5?1-2*i:2*i-1,s=r<1/n?o*r*r:r<2/n?o*(r-=1.5/n)*r+.75:r<2.5/n?o*(r-=2.25/n)*r+.9375:o*(r-=2.625/n)*r+.984375,s=i<.5?(1-r)/1:(1+r)/1,t*s+e},tweens:[],wait:u.wait};e.easeInOutQuad=e.ease,window.tween=e}window.matter={on(e,t){Matter.Events.on(rooms.current.matterEngine,e,t)},off(e,t){Matter.Events.off(rooms.current.matterEngine,e,t)},teleport(e,t,i){Matter.Body.setPosition(e.matterBody,{x:t,y:i}),e.x=t,e.y=i},push(e,t,i,o,n){void 0===o?Matter.Body.applyForce(e.matterBody,e.matterBody.position,{x:t,y:i}):Matter.Body.applyForce(e.matterBody,{x:o,y:n},{x:t,y:i})},spin(e,t){Matter.Body.setAngularVelocity(e.matterBody,u.degToRad(t))},rotate(e,t){Matter.Body.setAngle(e.matterBody,u.degToRad(t))},rotateBy(e,t){Matter.Body.rotate(e.matterBody,u.degToRad(t))},scale(e,t,i){Matter.Body.scale(e,t,i),e.scale.x=t,e.scale.y=i},launch(e,t,i){Matter.Body.setVelocity(e.matterBody,{x:t,y:i})},pin(e){const t=Matter.Constraint.create({bodyB:e.matterBody,pointA:{x:e.x,y:e.y},length:0});return Matter.World.add(rooms.current.matterWorld,t),t},tie(e,t,i=.05,o=.05){const n=Matter.Constraint.create({bodyB:e.matterBody,pointA:t,pointB:{x:0,y:0},stiffness:i,damping:o});return Matter.World.add(rooms.current.matterWorld,n),n},rope(e,t,i=.05,o=.05){const n=Matter.Constraint.create({pointA:e.position,bodyB:e.matterBody,length:t,stiffness:i,damping:o});return Matter.World.add(rooms.current.matterWorld,n),n},tieTogether(e,t,i,o){const n=Matter.Constraint.create({bodyA:e.matterBody,bodyB:t.matterBody,stiffness:i,damping:o});return Matter.World.add(rooms.current.matterWorld,n),n},onCreate(e){const t={isStatic:e.matterStatic,isSensor:e.matterSensor,restitution:e.matterRestitution||.1,friction:void 0===e.matterFriction?1:e.matterFriction,frictionStatic:void 0===e.matterFrictionStatic?.1:e.matterFrictionStatic,frictionAir:e.matterFrictionAir||.01,density:e.matterDensity||.001};if("rect"===e.shape.type&&(e.matterBody=Matter.Bodies.rectangle(e.x-e.shape.left,e.y-e.shape.top,e.shape.left+e.shape.right,e.shape.top+e.shape.bottom,t)),"circle"===e.shape.type&&(e.matterBody=Matter.Bodies.circle(e.x,e.y,e.shape.r,t)),"strip"===e.shape.type){const i=Matter.Vertices.create(e.shape.points);e.matterBody=Matter.Bodies.fromVertices(e.x,e.y,i,t)}Matter.Body.setCentre(e.matterBody,{x:(e.texture.defaultAnchor.x-.5)*e.texture.width,y:(e.texture.defaultAnchor.y-.5)*e.texture.height},!0),Matter.Body.setPosition(e.matterBody,e.position),Matter.Body.setAngle(e.matterBody,u.degToRad(e.angle)),Matter.Body.scale(e.matterBody,e.scale.x,e.scale.y),Matter.World.add(rooms.current.matterWorld,e.matterBody),e.matterBody.copy=e,e.matterFixPivot&&e.matterFixPivot[0]&&([e.pivot.x]=e.matterFixPivot),e.matterFixPivot&&e.matterFixPivot[1]&&([,e.pivot.y]=e.matterFixPivot),"pinpoint"===e.matterConstraint?e.constraint=window.matter.pin(e):"rope"===e.matterConstraint&&(e.constraint=window.matter.rope(e,0===e.matterRopeLength?64:e.matterRopeLength,0===e.matterRopeStiffness?.05:e.matterRopeStiffness,0===e.matterRopeDamping?.05:e.matterRopeDamping))},createStaticTilemap(e){const t={isStatic:!0,isSensor:!1,restitution:e.matterRestitution||.1,friction:void 0===e.matterFriction?1:e.matterFriction};for(const i of e.tiles)window.matter.createStaticTile(i,t)},createStaticTile(e,t){const{shape:i}=e.sprite;if("rect"===i.type)e.matterBody=Matter.Bodies.rectangle(e.x-i.left,e.y-i.top,i.left+i.right,i.top+i.bottom,t);else if("circle"===i.type)e.matterBody=Matter.Bodies.circle(e.x,e.y,i.r,t);else if("strip"===i.type){const o=Matter.Vertices.create(i.points);e.matterBody=Matter.Bodies.fromVertices(e.x,e.y,o,t)}Matter.Body.setCentre(e.matterBody,{x:(e.sprite.texture.defaultAnchor.x-.5)*e.sprite.texture.width,y:(e.sprite.texture.defaultAnchor.y-.5)*e.sprite.texture.height},!0),Matter.Body.setPosition(e.matterBody,e.sprite.position),Matter.World.add(rooms.current.matterWorld,e.matterBody)},getImpact(e){const{bodyA:t,bodyB:i}=e;if(t.isSensor||i.isSensor)return 0;const o=t.mass===1/0?0:t.mass,n=i.mass===1/0?0:i.mass;return u.pdc(t.velocity.x*o,t.velocity.y*o,i.velocity.x*n,i.velocity.y*n)},walkOverWithRulebook(e,t){if(t.length&&e.length)for(const i of t){const t=window.matter.getImpact(i),o=[i.bodyA,i.bodyB];for(const n of o)if(n.copy)for(const o of e)if(n.copy.template===o.mainTemplate){const e=i.bodyA===n?i.bodyB:i.bodyA;(o.any||e.copy&&o.otherTemplate===e.copy.template)&&o.func.apply(n.copy,[e.copy||e.tile,t])}}},rulebookStart:[],rulebookActive:[],rulebookEnd:[]};let xt=null,wt=0;function bt(e,t,i){switch(t){case"Brain":e.brain=i;break;case"Digestion":e.digestion=i;break;case"Growth":e.growth=i;break;case"Immunity":e.immunity=i;break;case"Protection":e.protection=i}null!=i&&function(e){null!=e.brain&&null!=e.digestion&&null!=e.growth&&null!=e.immunity&&null!=e.protection&&(console.log("Complete Sequence!"),e.brain.kill=!0,e.digestion.kill=!0,e.growth.kill=!0,e.immunity.kill=!0,e.protection.kill=!0)}(e)}function vt(){let e=Math.floor(100*Math.random()),t="";return e>.3?t=e<=.65?"HMO_":"BLactis_":e>.15&&e<=.3?t="Protein_":e<=.15&&(t="Sucrose_"),console.log(e),t}})();